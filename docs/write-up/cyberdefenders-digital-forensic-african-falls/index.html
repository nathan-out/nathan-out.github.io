

<!DOCTYPE html>
<html
  lang="fr-fr"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="false"
><head>
  <meta charset="utf-8" />
  
    <meta http-equiv="content-language" content="fr-fr" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Cyberdefenders · Digital Forensic · African Falls &middot; nathan.out</title>
    <meta name="title" content="Cyberdefenders · Digital Forensic · African Falls &middot; nathan.out" />
  
  
  
  
  
  <link rel="canonical" href="https://nathan-out.github.io/write-up/cyberdefenders-digital-forensic-african-falls/" />
  
  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.3be096bcd7d4e68dd376b85e8c0157153f5ad62d1d8da3aa541971bdc763082a2357c4f56750b40c029adc50e54e156d1535c7d6a4cfe2f9fe7b128da3507509.css"
    integrity="sha512-O&#43;CWvNfU5o3TdrhejAFXFT9a1i0djaOqVBlxvcdjCCojV8T1Z1C0DAKa3FDlThVtFTXH1qTP4vn&#43;exKNo1B1CQ=="
  />
  
  
  <script type="text/javascript" src="/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js" integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1&#43;ko&#43;UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
  
    
    
    
  
  
    
    
  
  
  
    
    <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.15ae6e2c9b1ac24a9ccf40003fa689efb1a18db1ee9b73d780b01a6c31b150441415862513e93184f68fe385759e4698b8763cba6a0f79493c1fed99ad5868d4.js" integrity="sha512-Fa5uLJsawkqcz0AAP6aJ77GhjbHum3PXgLAabDGxUEQUFYYlE&#43;kxhPaP44V1nkaYuHY8umoPeUk8H&#43;2ZrVho1A==" data-copy="Copier" data-copied="Copié"></script>
  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="Cyberdefenders · Digital Forensic · African Falls" />
<meta property="og:description" content="The scenario:
John Doe was accused of doing illegal activities. A disk image of his laptop was taken." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nathan-out.github.io/write-up/cyberdefenders-digital-forensic-african-falls/" /><meta property="article:section" content="write-up" />
<meta property="article:published_time" content="2023-08-12T11:22:06+03:00" />
<meta property="article:modified_time" content="2023-08-12T11:22:06+03:00" /><meta property="og:site_name" content="nathan.out" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cyberdefenders · Digital Forensic · African Falls"/>
<meta name="twitter:description" content="The scenario:
John Doe was accused of doing illegal activities. A disk image of his laptop was taken."/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Write-up",
    "name": "Cyberdefenders · Digital Forensic · African Falls",
    "headline": "Cyberdefenders · Digital Forensic · African Falls",
    
    "abstract": "The scenario:\nJohn Doe was accused of doing illegal activities. A disk image of his laptop was taken.",
    "inLanguage": "fr-fr",
    "url" : "https:\/\/nathan-out.github.io\/write-up\/cyberdefenders-digital-forensic-african-falls\/",
    "author" : {
      "@type": "Person",
      "name": "nathan.out"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-08-12T11:22:06\u002b03:00",
    "datePublished": "2023-08-12T11:22:06\u002b03:00",
    
    "dateModified": "2023-08-12T11:22:06\u002b03:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "1741"
  }]
  </script>


  
  <meta name="author" content="nathan.out" />
  
    
      <link href="https://github.com/nathan-out" rel="me" />
    
  
  
  






  
  
  


  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0"
        href="#main-content"
        ><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400"
          >&darr;</span
        >Aller au contenu</a
      >
    </div>
    
    
      <header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden">
  <nav class="flex justify-between">
    
    <div>
      
        <a
          class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
          rel="me"
          href="/"
          >nathan.out</a
        >
      

    </div>
    
    
      <ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row">
        
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/posts/"
                title="Mes articles"
                >Articles</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/a-propos/"
                title="A Propos"
                >A propos</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/write-up/"
                title="Write-up"
                >Write-up</a
              >
            </li>
          
        
        
          <li class="ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
            <button
              id="search-button"
              class="text-base hover:text-primary-600 dark:hover:text-primary-400"
              title="Rechercher (/)"
            >
              

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
          </li>
        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
        <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >Blog</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/write-up/"
      >Write-up</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/write-up/cyberdefenders-digital-forensic-african-falls/"
      >Cyberdefenders · Digital Forensic · African Falls</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Cyberdefenders · Digital Forensic · African Falls
      </h1>
      <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2023-08-12 11:22:06 &#43;0300 &#43;0300">12 août 2023</time><span class="px-2 text-primary-500">&middot;</span><span title="Temps de lecture">9 mins</span>
    

    
    
  </div>

  
  


      </div>
    </header>
    <section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert">
      
        <div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last">
          <div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden">
            <details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700"
  >
    Sommaire
  </summary>
  <div
    class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#abstract">Abstract</a></li>
    <li><a href="#q1-what-is-the-md5-hash-value-of-the-suspect-disk">Q1. What is the MD5 hash value of the suspect disk?</a></li>
    <li><a href="#q2-what-phrase-did-the-suspect-search-for-on-2021-04-29-181738-utc-three-words-two-spaces-in-between">Q2. What phrase did the suspect search for on 2021-04-29 18:17:38 UTC? (three words, two spaces in between)</a></li>
    <li><a href="#q3-what-is-the-ipv4-address-of-the-ftp-server-the-suspect-connected-to">Q3. What is the IPv4 address of the FTP server the suspect connected to?</a></li>
    <li><a href="#q4-what-date-and-time-was-a-password-list-deleted-in-utc-yyyy-mm-dd-hhmmss-utc">Q4. What date and time was a password list deleted in UTC? (YYYY-MM-DD HH:MM:SS UTC)</a></li>
    <li><a href="#q5-how-many-times-was-tor-browser-ran-on-the-suspects-computer-number-only">Q5. How many times was Tor Browser ran on the suspect&rsquo;s computer? (number only)</a></li>
    <li><a href="#q6-what-is-the-suspects-email-address">Q6. What is the suspect&rsquo;s email address?</a></li>
    <li><a href="#q7-what-is-the-fqdn-did-the-suspect-port-scan">Q7. What is the FQDN did the suspect port scan?</a></li>
    <li><a href="#q8-what-country-was-picture-20210429_152043jpg-allegedly-taken-in">Q8. What country was picture &ldquo;20210429_152043.jpg&rdquo; allegedly taken in?</a></li>
    <li><a href="#q9-what-is-the-parent-folder-name-picture-20210429_151535jpg-was-in-before-the-suspect-copy-it-to-contact-folder-on-his-desktop">Q9. What is the parent folder name picture &ldquo;20210429_151535.jpg&rdquo; was in before the suspect copy it to &ldquo;contact&rdquo; folder on his desktop?</a></li>
    <li><a href="#q10-a-windows-password-hashes-for-an-account-are-below-what-is-the-users-password">Q10. A Windows password hashes for an account are below. What is the user&rsquo;s password?</a></li>
    <li><a href="#q11-what-is-the-user-john-does-windows-login-password">Q11. What is the user &ldquo;John Doe&rsquo;s&rdquo; Windows login password?</a></li>
  </ul>
</nav>
  </div>
</details>

          </div>
        </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        <p>The scenario:</p>
<blockquote>
<p>John Doe was accused of doing illegal activities. A disk image of his laptop was taken. Your task as a soc analyst is to analyze the image and understand what happened under the hood.</p>
</blockquote>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/img/write-up/african-falls-illustration.png" alt="African falls illustration made by Midjourney." />
      
    </figure>
  

</p>
<figcaption>African falls illustration made by Midjourney.</figcaption>
<h2 id="abstract" class="relative group">Abstract <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#abstract" aria-label="Ancre">#</a></span></h2>
<p>The article describes a forensic challenge involving the analysis of a disk image from a laptop belonging to a suspect named John Doe, who is accused of illegal activities. The task for a SOC analyst is to uncover various pieces of information from the disk image, using a combination of tools including FTK Imager, Autopsy, command line utilities, and specialized tools like Metadata2go. The challenge consists of multiple questions aimed at extracting specific details, such as the MD5 hash value of the suspect&rsquo;s disk, phrases searched, connected FTP server&rsquo;s IPv4 address, deleted files, Tor Browser usage, email address, network port scan details, photo metadata, and more.</p>
<p>The article provides detailed instructions on how to approach each question, highlighting the use of relevant tools and demonstrating the steps to extract the required information from the disk image. It involves analyzing a variety of artifacts, including web history, installed programs, file metadata, PowerShell history, and system registry data. The challenge concludes with insights into retrieving password hashes and cracking them to determine the user&rsquo;s Windows login password.</p>
<hr>
<p>First, mount the image using <a href="https://www.exterro.com/ftk-imager">FTK Imager</a> (Windows) or command lines tools (Linux), follow this very good tutorial: <a href="https://bwiggs.com/posts/2021-07-25-cyberdefenders-hacked/">Guide: mounting challenge disk image on Linux.</a>.</p>
<p><strong>Important</strong>: AD1 files are painfull to use with Autopsy, If you want to analyse AD1 file with this software, you will have troubles. As Autopsy is very powerfull and embed various parsing tools, it&rsquo;s convenient to use it. My method is to:</p>
<ol>
<li>
<p>Mount AD1 file with FTK Imager</p>
</li>
<li>
<p>Export files using FTK Imager (right-click &gt; Export files)</p>
</li>
<li>
<p>In Autopsy, Add Data Source &gt; Logical Files &gt; Add (select the previously exported files)</p>
</li>
<li>
<p>Data ingestion should now works :)</p>
</li>
</ol>
<h2 id="q1-what-is-the-md5-hash-value-of-the-suspect-disk" class="relative group">Q1. What is the MD5 hash value of the suspect disk? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q1-what-is-the-md5-hash-value-of-the-suspect-disk" aria-label="Ancre">#</a></span></h2>
<p>Image file creation log provides this information, check the <code>DiskDrigger.txt</code> you will find various information such as the MD5 hash.</p>
<h2 id="q2-what-phrase-did-the-suspect-search-for-on-2021-04-29-181738-utc-three-words-two-spaces-in-between" class="relative group">Q2. What phrase did the suspect search for on 2021-04-29 18:17:38 UTC? (three words, two spaces in between) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q2-what-phrase-did-the-suspect-search-for-on-2021-04-29-181738-utc-three-words-two-spaces-in-between" aria-label="Ancre">#</a></span></h2>
<p>Under <code>Data Artifacts &gt; Web History</code>, you get all the information, sort by time and you  will find two URLs at the given time: <code>password cracking lists - Google Search</code>.</p>
<p>Or, you can manually browe the history file here: <code>Users\John Doe\AppData\Local\Google\Chrome\User Data\Default\History</code>.</p>
<h2 id="q3-what-is-the-ipv4-address-of-the-ftp-server-the-suspect-connected-to" class="relative group">Q3. What is the IPv4 address of the FTP server the suspect connected to? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q3-what-is-the-ipv4-address-of-the-ftp-server-the-suspect-connected-to" aria-label="Ancre">#</a></span></h2>
<p>Little bit tricky as you must know the most famous FTP client: <a href="https://wiki.filezilla-project.org/">FileZilla</a>. To know if the software is installed go to <code>Data Artifacts &gt; Installed Programs</code>, there is FileZilla, let&rsquo;s read its log file.</p>
<p>If you don&rsquo;t have Autopsy you can browse <code>SOFTWARE</code> hive, you will find FileZilla too.</p>
<p>So FileZilla is installed, what&rsquo;s next? Application datas are located at <code>Users/&lt;Username&gt;/AppData/Roaming|Local/AppData/</code> where <code>Roaming|Local</code> means that you have to browse theses two directories. The main difference is that roaming datas will &ldquo;follow&rdquo; a user throught another domains, and local will not. During my forensic learning journey, I can say that sometimes it&rsquo;s located at <code>Roaming</code>, sometimes at <code>Local</code>, you have to dig into both.</p>
<p>Digging into <code>Local/FileZilla</code> is useless, there is only icons and stuff like that, not user datas. <code>Roaming/FileZilla/</code> contains xml files and especially <code>recentservers.xml</code>. There is our answer!</p>
<h2 id="q4-what-date-and-time-was-a-password-list-deleted-in-utc-yyyy-mm-dd-hhmmss-utc" class="relative group">Q4. What date and time was a password list deleted in UTC? (YYYY-MM-DD HH:MM:SS UTC) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q4-what-date-and-time-was-a-password-list-deleted-in-utc-yyyy-mm-dd-hhmmss-utc" aria-label="Ancre">#</a></span></h2>
<p>Using FTK Imager, I browsed <code>$Recycle.Bin</code>. When a user delete a file, this is the location where the file is put in Windows. To understand how does it works I found this article: <a href="https://medium.com/@akhi.pbm/recycle-bin-forensic-5e58e33e7f30">Recycle Bin Forensic.</a>.</p>
<blockquote>
<p>From windows Vista and later the recycler path was renamed as <code>C:\$Recycle.Bin\SID*\$I</code> and <code>C:\$Recyecle.Bin\SID*\$R</code> where <code>$I</code> contains meta data of the deleted file and <code>$R</code> contains actual deleted file.</p>
</blockquote>
<p>We have this exact structure, let&rsquo;s get the <code>$R</code> date modified timestamp: 29/04/2021 18:19:55. Opening it we can see that it&rsquo;s obviously a password list. The answer has to be in UTC format, we can assume that UTC is the system timezone, but instead let&rsquo;s investigate to confirm. System timezone is located in <code>SYSTEM</code> hive: <code>SYSTEM\&lt;CurrentControlSet&gt;\Control\TimeZoneInformation\TimeZoneKeyName</code>, which is <code>UTC</code>.</p>
<p><strong>But</strong>, this is not the answer, you have to provide the <code>$I</code> timestamp. I didn&rsquo;t searched why, to me it&rsquo;s more accurate to provide the <code>$R</code> one but maybe I misuderstood something. Two timestamps are close.</p>
<p><em>Note: I couldn&rsquo;t export <code>$Recycle.Bin</code> with FTK Imager, I didn&rsquo;t searched why an error occured. I wanted to add these files into Autopsy to observe if the tool can retrieve deleted files.</em></p>
<h2 id="q5-how-many-times-was-tor-browser-ran-on-the-suspects-computer-number-only" class="relative group">Q5. How many times was Tor Browser ran on the suspect&rsquo;s computer? (number only) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q5-how-many-times-was-tor-browser-ran-on-the-suspects-computer-number-only" aria-label="Ancre">#</a></span></h2>
<p>I found this article: <a href="https://frsecure.com/blog/windows-forensics-execution/">Windows Forensics : Evidence of Execution</a>. To summarize, in our case, one interesting artifact is prefecth.</p>
<blockquote>
<p>Prefetch essentially grabs all of the files associated with an application from disk and writes them to memory so the user doesn’t have to wait for them to be loaded from disk.</p>
</blockquote>
<p>In our case, it could be use to know how many times a given software was launched. Prefetch files are located at: <code>Windows\Prefetch</code> all files begin by the software name following by an ID. In our case we can find theses two files:</p>
<pre tabindex="0"><code>TORBROWSER-INSTALL-WIN64-10.0-F3C4DF19.pf
TORBROWSER-INSTALL-WIN64-10.0-F3C4DF19.pf.FileSlack
</code></pre><p>To read a pf file, I used <a href="https://ericzimmerman.github.io/#!index.md">PECmd (Eric Zimmerman tool)</a>, the output contains many informations, I only written the most usefull one for us:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>PECmd.exe -f TORBROWSER-INSTALL-WIN64-10.0-F3C4DF19.pf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Executable name: TORBROWSER-INSTALL-WIN64-10.0
</span></span><span style="display:flex;"><span>Hash: F3C4DF19
</span></span><span style="display:flex;"><span>File size <span style="color:#f92672">(</span>bytes<span style="color:#f92672">)</span>: 139.504
</span></span><span style="display:flex;"><span>Version: Windows <span style="color:#ae81ff">10</span> or Windows <span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Run count: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Last run: 2021-04-29 18:22:32
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>An intuitive answer could to answer 1, and that&rsquo;s what I did. But the program we are inspecting is not Tor Brower, it&rsquo;s <strong>Tor Installer</strong>. As we don&rsquo;t have a pf file for Tor Browser, the user never launched this program, just installed it.</p>
<h2 id="q6-what-is-the-suspects-email-address" class="relative group">Q6. What is the suspect&rsquo;s email address? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q6-what-is-the-suspects-email-address" aria-label="Ancre">#</a></span></h2>
<p>Autopsy provides an automatic email parser under <code>Analysis Result &gt; Keywords Hits &gt; Email addresses</code>, but there is many email addresses, we have to correlate with other datas. There is no emails sofware installed nor emails datas in the computer. The only way that the user uses email is throught a web browser, let&rsquo;s investigate into <code>Data Artifacts &gt; Web History</code>:</p>
<pre tabindex="0"><code>https://protonmail.com/login
https://protonmail.com/inbox
</code></pre><p>Unfortunately, we have 6 proton emails addresses in the computer:</p>
<pre tabindex="0"><code>contact@protonmail.com
dreammaker82@protonmail.com
notify@protonmail.com
security@protonmail.com
support@protonmail.com
username2@protonmail.com
</code></pre><p>Using the <code>Data Artifacts &gt; Web Form Autofill</code>, which are the web browser form saved values, we can see a known username <code>dreammaker82</code>. Theses datas can be accessed at: <code>Users/John Doe/AppData/Local/Google/Chrome/User Data/Default/Web Data</code>.</p>
<h2 id="q7-what-is-the-fqdn-did-the-suspect-port-scan" class="relative group">Q7. What is the FQDN did the suspect port scan? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q7-what-is-the-fqdn-did-the-suspect-port-scan" aria-label="Ancre">#</a></span></h2>
<p>Which program can be used to make network scanning? Nmap of course, and it&rsquo;s installed on the computer <code>Data Artifacts &gt; Installed Programs</code>.</p>
<p>So now the question is, how can I find the nmap history or equivalent? I was unable to find some nmap logs or something else. But as nmap is a CLI-tool, you can retrieve the command launched in the Power-Shell history.</p>
<p>The history is located at: <code>Users\John Doe\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code>. Here, you can see that the user perform this network scanning:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ping dfir.science
</span></span><span style="display:flex;"><span>nmap dfir.science
</span></span></code></pre></div><h2 id="q8-what-country-was-picture-20210429_152043jpg-allegedly-taken-in" class="relative group">Q8. What country was picture &ldquo;20210429_152043.jpg&rdquo; allegedly taken in? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q8-what-country-was-picture-20210429_152043jpg-allegedly-taken-in" aria-label="Ancre">#</a></span></h2>
<p>My first idea was to made a reverse Google/Yandex image search. I found nothing interesting, so I decided to inspect metadatas. First, I extracted the file with Autopsy or FTK Imager. <strong>Using the Windows property will not show all metadatas, you have to use a dedicated tool.</strong> I found this one: <a href="https://www.metadata2go.com/">Metadata2go</a>. Juste upload the photo and the tool will process the image for you. There is many metadatas and some of them are really interesting:</p>
<pre tabindex="0"><code>gps_latitude:   16 deg 0&#39; 0.00&#34; S
gps_longitude:  23 deg 0&#39; 0.00&#34; E
gps_position:   16 deg 0&#39; 0.00&#34; S, 23 deg 0&#39; 0.00&#34; E
</code></pre><p><a href="https://www.itilog.com/">Itilog.com</a> will give you the location from the coordinates. Please be sure how the coordinate system works, otherwise the tool will give you a wrong country (Chad). As the latitude is with the letter &lsquo;S&rsquo;, you have to provide this value too. The country is Zambia.</p>
<h2 id="q9-what-is-the-parent-folder-name-picture-20210429_151535jpg-was-in-before-the-suspect-copy-it-to-contact-folder-on-his-desktop" class="relative group">Q9. What is the parent folder name picture &ldquo;20210429_151535.jpg&rdquo; was in before the suspect copy it to &ldquo;contact&rdquo; folder on his desktop? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q9-what-is-the-parent-folder-name-picture-20210429_151535jpg-was-in-before-the-suspect-copy-it-to-contact-folder-on-his-desktop" aria-label="Ancre">#</a></span></h2>
<p>I was not able to answer this question, but it&rsquo;s quite easy, I quote this another writeup from <a href="https://www.jamesgibbins.com/posts/cyberdefenders-africafalls/#11-what-is-the-user-john-does-windows-login-password">jamesgibbins.com</a></p>
<blockquote>
<p>Looking at the file metadata in Autopsy, we can see it was taken by an LG Electronics LM-Q725K, which is a smartphone. If we look in USB Device Attached, we can see it there too: LG Electronics, Inc. LM-X420xxx/G2/G3 Android Phone (MTP/download mode). Background knowledge time, many cameras store photos in a DCIM, or a subfolder of this folder. If we search for DCIM, we get a Shell Bags Artifact relating to this photo: <code>My Computer\LG Q7\Internal storage\DCIM\Camera</code></p>
</blockquote>
<h2 id="q10-a-windows-password-hashes-for-an-account-are-below-what-is-the-users-password" class="relative group">Q10. A Windows password hashes for an account are below. What is the user&rsquo;s password? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q10-a-windows-password-hashes-for-an-account-are-below-what-is-the-users-password" aria-label="Ancre">#</a></span></h2>
<p>The question give this information:</p>
<pre tabindex="0"><code>Anon:1001:aad3b435b51404eeaad3b435b51404ee:3DE1A36F6DDB8E036DFD75E8E20C4AF4:::
</code></pre><p>I don&rsquo;t know why this question pop, its not related at all to the challenge. Use an online tool, or John or Hashcat.</p>
<h2 id="q11-what-is-the-user-john-does-windows-login-password" class="relative group">Q11. What is the user &ldquo;John Doe&rsquo;s&rdquo; Windows login password? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q11-what-is-the-user-john-does-windows-login-password" aria-label="Ancre">#</a></span></h2>
<p>Users informations, included NTLM password, hashes are stored in <code>SAM</code> hive. But Autopsy can&rsquo;t read them (maybe because it&rsquo;s protected?), we have to be more more &ldquo;aggressive&rdquo;. <a href="https://github.com/gentilkiwi/mimikatz/">Mimikatz</a> can be used to dump NTLM hashes.</p>
<p>Once you have deactivated securities (Mimikatz is a well-known offensive tool, flagged by every security solution), let&rsquo;s launch the tool. It was the first time I used this tool, apologies for mistakes. Before dumping hashes, you have to export <code>SAM</code> and <code>SYSTEM</code> hives.</p>
<pre tabindex="0"><code>  .#####.   mimikatz 2.2.0 (x86) #19041 Sep 19 2022 17:43:26
 .## ^ ##.  &#34;A La Vie, A L&#39;Amour&#34; - (oe.eo)
 ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
 ## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz
 &#39;## v ##&#39;       Vincent LE TOUX             ( vincent.letoux@gmail.com )
  &#39;#####&#39;        &gt; https://pingcastle.com / https://mysmartlogon.com ***/

mimikatz # lsadump::sam /system:&lt;SYSTEM file path&gt; /sam:&lt;SAM file path&gt;

...
RID  : 000003e9 (1001)
User : John Doe
  Hash NTLM: ecf53750b76cc9a62057ca85ff4c850e

Supplemental Credentials:
* Primary:NTLM-Strong-NTOWF *
    Random Value : 7844054d945112afaa36825b3ffcedfc
...
</code></pre><p>The tool will display all user information, including sensitive datas such as password hashes. Now, you just have to launch a password cracker like John or Hashcat to brute-force the hash and retrieve the password. It&rsquo;s an easy password so you should not wait too long.</p>

      </div>
    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      
  <div class="flex">
    
      
      
        
        <img
          class="w-24 h-24 !mt-0 !mb-0 ltr:mr-4 rtl:ml-4 rounded-full"
          width="96"
          height="96"
          alt="nathan.out"
          src="/img/author_hu00bba01d950a59fc7877b060fc60a3bd_21567_192x192_fill_q75_box_smart1.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] leading-3 text-neutral-500 dark:text-neutral-400 uppercase">
          Auteur
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          nathan.out
        </div>
      
      
      <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/nathan-out"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</a
        >
      
    
  </div>

</div>
    </div>
  </div>


      

      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group" href="/write-up/cyberdefenders-digital-forensic-hacked/">
              <span
                class="mr-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Cyberdefenders · Digital Forensic · Hacked</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-08-12 11:20:47 &#43;0300 &#43;0300">12 août 2023</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group" href="/write-up/cyberdefenders-spotlight/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Cyberdefenders · Digital Forensic · Spotlight</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-09-03 22:05:39 &#43;0200 CEST">3 septembre 2023</time>
                  
                </span>
              </span>
              <span
                class="ml-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        
          <div
            class="absolute top-[100vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0"
          >
            <a
              href="#the-top"
              class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
              aria-label="Faire défiler jusqu&#39;au bas de la page"
              title="Faire défiler jusqu&#39;au bas de la page"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <div class="flex items-center justify-between">
    <div>
      
      
        <p class="text-sm text-neutral-500 dark:text-neutral-400">
            &copy;
            2023
            nathan.out
        </p>
      
      
      
    </div>
    
    
      <div
        class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14"
      >
        <button
          id="appearance-switcher"
          class="w-12 h-12 "
          type="button"
          title="Passer au thème sombre"
        >
          <span class="inline dark:hidden">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>

</span>
          <span class="hidden dark:inline">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>

</span>
        </button>
      </div>
    
  </div>
  
  
</footer>
<div
  id="search-wrapper"
  class="fixed inset-0 z-50 flex flex-col p-4 sm:p-6 md:p-[10vh] lg:p-[12vh] w-screen h-screen cursor-default bg-neutral-500/50 backdrop-blur-sm dark:bg-neutral-900/50 invisible"
  data-url="https://nathan-out.github.io/"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg border-neutral-200 top-20 bg-neutral dark:bg-neutral-800 dark:border-neutral-700"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-transparent focus:outline-2"
          placeholder="Rechercher"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
        title="Fermer (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
</html>
