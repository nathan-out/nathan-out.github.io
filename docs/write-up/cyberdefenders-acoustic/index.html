

<!DOCTYPE html>
<html
  lang="fr-fr"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="false"
><head>
  <meta charset="utf-8" />
  
    <meta http-equiv="content-language" content="fr-fr" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Cyberdefenders · Digital Forensic · Acoustic &middot; nathan.out</title>
    <meta name="title" content="Cyberdefenders · Digital Forensic · Acoustic &middot; nathan.out" />
  
  
  
  
  
  <link rel="canonical" href="https://nathan-out.github.io/write-up/cyberdefenders-acoustic/" />
  
  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.e5be5b53889669547934e328d05cfccbbd4c7cb9ae060540fd2b23be0188697dd0810155c6b8b189c57ec29b1c16d33891d662f591ff23879825e15bd06414e7.css"
    integrity="sha512-5b5bU4iWaVR5NOMo0Fz8y71MfLmuBgVA/SsjvgGIaX3QgQFVxrixicV&#43;wpscFtM4kdZi9ZH/I4eYJeFb0GQU5w=="
  />
  
  
  <script type="text/javascript" src="/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js" integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1&#43;ko&#43;UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
  
    
    
    
  
  
    
    
  
  
  
    
    <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.15ae6e2c9b1ac24a9ccf40003fa689efb1a18db1ee9b73d780b01a6c31b150441415862513e93184f68fe385759e4698b8763cba6a0f79493c1fed99ad5868d4.js" integrity="sha512-Fa5uLJsawkqcz0AAP6aJ77GhjbHum3PXgLAabDGxUEQUFYYlE&#43;kxhPaP44V1nkaYuHY8umoPeUk8H&#43;2ZrVho1A==" data-copy="Copier" data-copied="Copié"></script>
  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="Cyberdefenders · Digital Forensic · Acoustic" />
<meta property="og:description" content="The scenario:
This challenge takes you into the world of voice communications on the internet." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nathan-out.github.io/write-up/cyberdefenders-acoustic/" /><meta property="article:section" content="write-up" />
<meta property="article:published_time" content="2023-09-03T22:08:20+02:00" />
<meta property="article:modified_time" content="2023-09-03T22:08:20+02:00" /><meta property="og:site_name" content="nathan.out" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cyberdefenders · Digital Forensic · Acoustic"/>
<meta name="twitter:description" content="The scenario:
This challenge takes you into the world of voice communications on the internet."/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Write-up",
    "name": "Cyberdefenders · Digital Forensic · Acoustic",
    "headline": "Cyberdefenders · Digital Forensic · Acoustic",
    
    "abstract": "The scenario:\nThis challenge takes you into the world of voice communications on the internet.",
    "inLanguage": "fr-fr",
    "url" : "https:\/\/nathan-out.github.io\/write-up\/cyberdefenders-acoustic\/",
    "author" : {
      "@type": "Person",
      "name": "nathan.out"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-09-03T22:08:20\u002b02:00",
    "datePublished": "2023-09-03T22:08:20\u002b02:00",
    
    "dateModified": "2023-09-03T22:08:20\u002b02:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "1196"
  }]
  </script>


  
  <meta name="author" content="nathan.out" />
  
    
      <link href="https://github.com/nathan-out" rel="me" />
    
  
  
  






  
  
  


  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0"
        href="#main-content"
        ><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400"
          >&darr;</span
        >Aller au contenu</a
      >
    </div>
    
    
      <header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden">
  <nav class="flex justify-between">
    
    <div>
      
        <a
          class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
          rel="me"
          href="/"
          >nathan.out</a
        >
      

    </div>
    
    
      <ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row">
        
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/posts/"
                title="Mes articles"
                >Articles</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/a-propos/"
                title="A Propos"
                >A propos</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/write-up/"
                title="Write-up"
                >Write-up</a
              >
            </li>
          
        
        
          <li class="ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
            <button
              id="search-button"
              class="text-base hover:text-primary-600 dark:hover:text-primary-400"
              title="Rechercher (/)"
            >
              

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
          </li>
        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
        <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >Blog</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/write-up/"
      >Write-up</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/write-up/cyberdefenders-acoustic/"
      >Cyberdefenders · Digital Forensic · Acoustic</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Cyberdefenders · Digital Forensic · Acoustic
      </h1>
      <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2023-09-03 22:08:20 &#43;0200 CEST">3 septembre 2023</time><span class="px-2 text-primary-500">&middot;</span><span title="Temps de lecture">6 mins</span>
    

    
    
  </div>

  
  


      </div>
    </header>
    <section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert">
      
        <div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last">
          <div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden">
            <details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700"
  >
    Sommaire
  </summary>
  <div
    class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#abstract">Abstract</a></li>
    <li><a href="#q1-what-is-the-transport-protocol-being-used">Q1. What is the transport protocol being used?</a></li>
    <li><a href="#q2-the-attacker-used-a-bunch-of-scanning-tools-that-belong-to-the-same-suite-provide-the-name-of-the-suite">Q2. The attacker used a bunch of scanning tools that belong to the same suite. Provide the name of the suite.</a></li>
    <li><a href="#q3-what-is-the-user-agent-of-the-victim-system">Q3. What is the User-Agent of the victim system?</a></li>
    <li><a href="#q4-which-tool-was-only-used-against-the-following-extensions-100101102103-and-111">Q4. Which tool was only used against the following extensions: 100,101,102,103, and 111?</a></li>
    <li><a href="#q5-which-extension-on-the-honeypot-does-not-require-authentication">Q5. Which extension on the honeypot does NOT require authentication?</a></li>
    <li><a href="#q6-how-many-extensions-were-scanned-in-total">Q6. How many extensions were scanned in total?</a></li>
    <li><a href="#q7-there-is-a-trace-for-a-real-sip-client-what-is-the-corresponding-user-agent-two-words-once-space-in-between">Q7. There is a trace for a real SIP client. What is the corresponding user-agent? (two words, once space in between)</a></li>
    <li><a href="#q8-multiple-real-world-phone-numbers-were-dialed-provide-the-first-11-digits-of-the-number-dialed-from-extension-101">Q8. Multiple real-world phone numbers were dialed. Provide the first 11 digits of the number dialed from extension 101?</a></li>
    <li><a href="#q9-what-are-the-default-credentials-used-in-the-attempted-basic-authentication-format-is-usernamepassword">Q9. What are the default credentials used in the attempted basic authentication? (format is username:password)</a></li>
    <li><a href="#q11-which-codec-does-the-rtp-stream-use-3-words-2-spaces-in-between">Q11. Which codec does the RTP stream use? (3 words, 2 spaces in between)</a></li>
    <li><a href="#q12-how-long-is-the-sampling-time-in-milliseconds">Q12. How long is the sampling time (in milliseconds)?</a></li>
    <li><a href="#q13-what-was-the-password-for-the-account-with-username-555">Q13. What was the password for the account with username 555?</a></li>
    <li><a href="#q14-which-rtp-packet-header-field-can-be-used-to-reorder-out-of-sync-rtp-packets-in-the-correct-sequence">Q14. Which RTP packet header field can be used to reorder out of sync RTP packets in the correct sequence?</a></li>
    <li><a href="#q15-the-trace-includes-a-secret-hidden-message-can-you-hear-it">Q15. The trace includes a secret hidden message. Can you hear it?</a></li>
  </ul>
</nav>
  </div>
</details>

          </div>
        </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        <p>The scenario:</p>
<blockquote>
<p>This challenge takes you into the world of voice communications on the internet. VoIP is becoming the de-facto standard for voice communication. As this technology becomes more common, malicious parties have more opportunities and stronger motives to control these systems to conduct nefarious activities. This challenge was designed to examine and explore some of the attributes of the SIP and RTP protocols.</p>
</blockquote>
<h2 id="abstract" class="relative group">Abstract <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#abstract" aria-label="Ancre">#</a></span></h2>
<p>The article delves into the realm of voice communications on the internet, focusing on Voice over Internet Protocol (VoIP) technology. VoIP has become the standard for voice communication, but with its widespread adoption comes the risk of malicious exploitation. This challenge explores the Session Initiation Protocol (SIP) and Real-Time Transport Protocol (RTP) attributes to understand and counteract potential threats.</p>
<p>A series of questions guide the exploration, covering topics such as identifying the transport protocol, suites of scanning tools, User-Agent of the victim system, extensions requiring authentication, scanned extensions, real SIP client traces, dialed phone numbers, default credentials, RTP codec usage, sampling time, and uncovering hidden messages.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/img/write-up/acoustic/sipvicious.png" alt="SIPVicious OSS logo; SIP-based VoIP systems security testing toolset." />
      
    </figure>
  

</p>
<figcaption>SIPVicious OSS logo; SIP-based VoIP systems security testing toolset.</figcaption>
<hr>
<h2 id="q1-what-is-the-transport-protocol-being-used" class="relative group">Q1. What is the transport protocol being used? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q1-what-is-the-transport-protocol-being-used" aria-label="Ancre">#</a></span></h2>
<p>The first thing I like to do with Wireshark is to have an overview. Statistics &gt; Protocol Hierarchy provides general information about the capture.</p>
<p>



  
  
  
    <figure>
      <img class="my-0 rounded-md" src="/img/write-up/acoustic/statistics.png" alt="Capture overview." />
      
    </figure>
  

</p>
<figcaption>Capture overview.</figcaption>
<p>We can see two unusual protocols here: <code>Session Initiation Protocol</code> and <code>Real-Time Transport Protocol</code>. According to the <a href="https://en.wikipedia.org/wiki/Session_Initiation_Protocol">SIP&rsquo;s Wikipedia page</a>:</p>
<blockquote>
<p>SIP is designed to be independent of the underlying transport layer protocol and can be used with the User Datagram Protocol (UDP), the Transmission Control Protocol (TCP), and the Stream Control Transmission Protocol (SCTP).</p>
</blockquote>
<p>In the statistics, we can see that <code>SIP</code> is under <code>UDP</code>.</p>
<h2 id="q2-the-attacker-used-a-bunch-of-scanning-tools-that-belong-to-the-same-suite-provide-the-name-of-the-suite" class="relative group">Q2. The attacker used a bunch of scanning tools that belong to the same suite. Provide the name of the suite. <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q2-the-attacker-used-a-bunch-of-scanning-tools-that-belong-to-the-same-suite-provide-the-name-of-the-suite" aria-label="Ancre">#</a></span></h2>
<p>I used the log file:</p>
<pre tabindex="0"><code>OPTIONS sip:100@honey.pot.IP.removed SIP/2.0
Via: SIP/2.0/UDP 127.0.0.1:5061;branch=z9hG4bK-2159139916;rport
Content-Length: 0
From: &#34;sipvicious&#34;&lt;sip:100@1.1.1.1&gt;; tag=X_removed
Accept: application/sdp
User-Agent: friendly-scanner
To: &#34;sipvicious&#34;&lt;sip:100@1.1.1.1&gt;
Contact: sip:100@127.0.0.1:5061
CSeq: 1 OPTIONS
Call-ID: 845752980453913316694142
Max-Forwards: 70
</code></pre><p>The user-agent is a good starting point, as I don&rsquo;t now anything in VoIP. Googling <code>friendly-scanner</code> will give some informations and especially this one:</p>
<blockquote>
<p>Also known as friendly-scanner, it is freely available to help pentesters, security teams and developers quickly test their SIP systems.</p>
</blockquote>
<p>From: <a href="https://www.enablesecurity.com/sipvicious/oss/">SIPVicious OSS - open-source tools for testing VoIP security</a>.</p>
<h2 id="q3-what-is-the-user-agent-of-the-victim-system" class="relative group">Q3. What is the User-Agent of the victim system? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q3-what-is-the-user-agent-of-the-victim-system" aria-label="Ancre">#</a></span></h2>
<p>Thanks to the hit, I have to check SIP packets. Filter this protocol by typing &lsquo;sip&rsquo; in the Wireshark&rsquo;s search bar. Then, follow a conversation (right-click &gt; follow &gt; UDP stream) and you will see this kind of datas:</p>
<pre tabindex="0"><code>OPTIONS sip:100@172.25.105.40 SIP/2.0
Via: SIP/2.0/UDP 127.0.1.1:5060;branch=z9hG4bK-1453809699;rport
Content-Length: 0
From: &#34;sipvicious&#34;&lt;sip:100@1.1.1.1&gt;; tag=6163313936393238313363340131323031353530343335
Accept: application/sdp
User-Agent: UNfriendly-scanner - for demo purposes
To: &#34;sipvicious&#34;&lt;sip:100@1.1.1.1&gt;
Contact: sip:100@127.0.1.1:5060
CSeq: 1 OPTIONS
Call-ID: 61127078793469957194131
Max-Forwards: 70

SIP/2.0 200 OK
Via: SIP/2.0/UDP 127.0.1.1:5060;branch=z9hG4bK-1453809699;received=172.25.105.43;rport=5060
From: &#34;sipvicious&#34;&lt;sip:100@1.1.1.1&gt;; tag=6163313936393238313363340131323031353530343335
To: &#34;sipvicious&#34;&lt;sip:100@1.1.1.1&gt;;tag=as18cdb0c9
Call-ID: 61127078793469957194131
CSeq: 1 OPTIONS
User-Agent: Asterisk PBX 1.6.0.10-FONCORE-r40
Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY
Supported: replaces, timer
Contact: &lt;sip:172.25.105.40&gt;
Accept: application/sdp
Content-Length: 0
</code></pre><h2 id="q4-which-tool-was-only-used-against-the-following-extensions-100101102103-and-111" class="relative group">Q4. Which tool was only used against the following extensions: 100,101,102,103, and 111? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q4-which-tool-was-only-used-against-the-following-extensions-100101102103-and-111" aria-label="Ancre">#</a></span></h2>
<p>SIP Vicious contains few tools:</p>
<ul>
<li>
<p>svmap</p>
</li>
<li>
<p>svwar</p>
</li>
<li>
<p>svcrack</p>
</li>
<li>
<p>svreport</p>
</li>
<li>
<p>svcrash</p>
</li>
</ul>
<p>I used hints and gone to source code of each tools. You have to read each tool code and in svcrack there is an interesting function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sipvicious.libs.svhelper <span style="color:#f92672">import</span> <span style="color:#f92672">...</span>makeRequest
</span></span></code></pre></div><p>This function is interesting because its used to forge the request and send it to the victim, you can find usefull information inside it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">makeRequest</span>(method, fromaddr, toaddr, dsthost, port, callid, srchost<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>, branchunique<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, cseq<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    auth<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, localtag<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, compact<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, contact<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sip:123@1.1.1.1&#39;</span>, accept<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;application/sdp&#39;</span>, contentlength<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>,
</span></span><span style="display:flex;"><span>    localport<span style="color:#f92672">=</span><span style="color:#ae81ff">5060</span>, extension<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, contenttype<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, body<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>, useragent<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;friendly-scanner&#39;</span>, requesturi<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span></code></pre></div><p>Because of the <code>useragent</code> variable, which match logged user-agent inside <code>log.txt</code>, we can answer <code>svcrack.py</code>.</p>
<h2 id="q5-which-extension-on-the-honeypot-does-not-require-authentication" class="relative group">Q5. Which extension on the honeypot does NOT require authentication? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q5-which-extension-on-the-honeypot-does-not-require-authentication" aria-label="Ancre">#</a></span></h2>
<p>I searched on <code>log.txt</code>, in this file you can find some <code>Authorization</code> header:</p>
<pre tabindex="0"><code>Authorization: Digest username=&#34;101&#34;,realm=&#34;localhost&#34;,nonce=&#34;3711809134&#34;,uri=&#34;sip:honey.pot.IP.removed&#34;,response=&#34;MD5_hash_removedXXXXXXXXXXXXXXXX&#34;,algorithm=MD5
</code></pre><p>It looks like an authentication, and, in this case, for user 101. I&rsquo;ve looked for the same header for user 100, 101, 102 and 103, and the only one that doesn&rsquo;t have this header is 100.</p>
<h2 id="q6-how-many-extensions-were-scanned-in-total" class="relative group">Q6. How many extensions were scanned in total? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q6-how-many-extensions-were-scanned-in-total" aria-label="Ancre">#</a></span></h2>
<p>I wasn&rsquo;t able to find the answer, I found something close to the answer but I haven&rsquo;t been able to find the answer. Please refer to another write-up for an explaination.</p>
<h2 id="q7-there-is-a-trace-for-a-real-sip-client-what-is-the-corresponding-user-agent-two-words-once-space-in-between" class="relative group">Q7. There is a trace for a real SIP client. What is the corresponding user-agent? (two words, once space in between) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q7-there-is-a-trace-for-a-real-sip-client-what-is-the-corresponding-user-agent-two-words-once-space-in-between" aria-label="Ancre">#</a></span></h2>
<p>Use a grep regex to find all the User-Agent:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -Ei <span style="color:#e6db74">&#39;User-Agent:&#39;</span> log.txt|uniq
</span></span></code></pre></div><h2 id="q8-multiple-real-world-phone-numbers-were-dialed-provide-the-first-11-digits-of-the-number-dialed-from-extension-101" class="relative group">Q8. Multiple real-world phone numbers were dialed. Provide the first 11 digits of the number dialed from extension 101? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q8-multiple-real-world-phone-numbers-were-dialed-provide-the-first-11-digits-of-the-number-dialed-from-extension-101" aria-label="Ancre">#</a></span></h2>
<p>As I don&rsquo;t know anything about SIP, I asked to ChatGPT how to find a dialed phone number. It answered me that you have to check <code>INVITE</code> request type. This command search for extension 101 with INVITE type.</p>
<pre tabindex="0"><code class="language-grep" data-lang="grep">grep -Ei &#39;From: &#34;Unknown&#34;&lt;sip:101&#39; log.txt -B8|grep INVITE
</code></pre><p>It returns 3 matchs:</p>
<pre tabindex="0"><code>INVITE sip:900114382089XXXX@honey.pot.IP.removed;transport=UDP SIP/2.0
INVITE sip:00112322228XXXX@honey.pot.IP.removed;transport=UDP SIP/2.0
INVITE sip:00112524021XXXX@honey.pot.IP.removed;transport=UDP SIP/2.0
</code></pre><p>We can forget the first one because it&rsquo;s not 11 digit long. I don&rsquo;t know why it&rsquo;s the last one, both of them have an INVITE request for extension 101. Maybe I forget something?</p>
<h2 id="q9-what-are-the-default-credentials-used-in-the-attempted-basic-authentication-format-is-usernamepassword" class="relative group">Q9. What are the default credentials used in the attempted basic authentication? (format is username:password) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q9-what-are-the-default-credentials-used-in-the-attempted-basic-authentication-format-is-usernamepassword" aria-label="Ancre">#</a></span></h2>
<p>Search for &lsquo;password&rsquo; in Wireshark: Edit &gt; Find a packet (don&rsquo;t forget to search for a <strong>string</strong>). In the HTTP paquets, you will find the credentials.</p>
<h2 id="q11-which-codec-does-the-rtp-stream-use-3-words-2-spaces-in-between" class="relative group">Q11. Which codec does the RTP stream use? (3 words, 2 spaces in between) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q11-which-codec-does-the-rtp-stream-use-3-words-2-spaces-in-between" aria-label="Ancre">#</a></span></h2>
<p>Filter the capture on <code>RTP</code> packet type and open one of them. There is no codec field but there is <code>payload type</code>, searching on &ldquo;rtp codec&rdquo; I found this page: <a href="https://en.wikipedia.org/wiki/RTP_payload_formats">RTP payload formats - Wikipedia</a>. In fact, the RTP payload format is related to the codec used:</p>
<blockquote>
<p>ITU-T G.711 PCM A-Law audio 64 kbit/s</p>
</blockquote>
<p>It looks like a codec, we found it!</p>
<h2 id="q12-how-long-is-the-sampling-time-in-milliseconds" class="relative group">Q12. How long is the sampling time (in milliseconds)? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q12-how-long-is-the-sampling-time-in-milliseconds" aria-label="Ancre">#</a></span></h2>
<p>Not really a DFIR question^^.</p>
<p>Go to <a href="https://en.wikipedia.org/wiki/G.711">G.711 - Wikipedia</a>, you will find that the sampling frequency is <strong>8kHz</strong>, 8000 times per second. To get the time between two samples, just calculate 1/8000 = 0.000125. As we want millisecond, multiply it by 1000 = <strong>0.125</strong>.</p>
<h2 id="q13-what-was-the-password-for-the-account-with-username-555" class="relative group">Q13. What was the password for the account with username 555? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q13-what-was-the-password-for-the-account-with-username-555" aria-label="Ancre">#</a></span></h2>
<p>The capture contains HTTP packets which seems related to the VoIP system interface. I extracted the HTTP objects but without find the answer.</p>
<p>The hint &rsquo;take a look at sip_custom.conf&rsquo; helped me a lot. I found packet number 1287 which contains many informations such as passwords:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">form</span>  <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;section_form&#34;</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post&#34;</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;?file=sip_custom.conf&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">hidden</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;themd5&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ee6207b44f73896fd799ad41c9e20947&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">hidden</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;updateSection&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sip_custom.conf&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">h2</span>&gt;Edit: sip_custom.conf&lt;/<span style="color:#f92672">h2</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">textarea</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;section_text&#34;</span> <span style="color:#a6e22e">cols</span><span style="color:#f92672">=</span><span style="color:#e6db74">100</span> <span style="color:#a6e22e">rows</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;30&#34;</span> <span style="color:#a6e22e">wrap</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;off&#34;</span>&gt;[555]
</span></span><span style="display:flex;"><span>type=friend
</span></span><span style="display:flex;"><span>username=555
</span></span><span style="display:flex;"><span>secret=1234
</span></span></code></pre></div><h2 id="q14-which-rtp-packet-header-field-can-be-used-to-reorder-out-of-sync-rtp-packets-in-the-correct-sequence" class="relative group">Q14. Which RTP packet header field can be used to reorder out of sync RTP packets in the correct sequence? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q14-which-rtp-packet-header-field-can-be-used-to-reorder-out-of-sync-rtp-packets-in-the-correct-sequence" aria-label="Ancre">#</a></span></h2>
<p>I found two header field:</p>
<ul>
<li>
<p>Sequence number</p>
</li>
<li>
<p>Timestamp</p>
</li>
</ul>
<p>I tried both, the answer is Timestamp, maybe Sequence number can be used for this feature too.</p>
<h2 id="q15-the-trace-includes-a-secret-hidden-message-can-you-hear-it" class="relative group">Q15. The trace includes a secret hidden message. Can you hear it? <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#q15-the-trace-includes-a-secret-hidden-message-can-you-hear-it" aria-label="Ancre">#</a></span></h2>
<p>Wireshark has the tool, go to : <code>Telephony &gt; RTP &gt; RTP Player</code>.</p>

      </div>
    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      
  <div class="flex">
    
      
      
        
        <img
          class="w-24 h-24 !mt-0 !mb-0 ltr:mr-4 rtl:ml-4 rounded-full"
          width="96"
          height="96"
          alt="nathan.out"
          src="/img/author_hu00bba01d950a59fc7877b060fc60a3bd_21567_192x192_fill_q75_box_smart1.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] leading-3 text-neutral-500 dark:text-neutral-400 uppercase">
          Auteur
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          nathan.out
        </div>
      
      
      <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/nathan-out"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</a
        >
      
    
  </div>

</div>
    </div>
  </div>


      

      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group" href="/write-up/cyberdefenders-spotlight/">
              <span
                class="mr-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Cyberdefenders · Digital Forensic · Spotlight</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-09-03 22:05:39 &#43;0200 CEST">3 septembre 2023</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        
          <div
            class="absolute top-[100vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0"
          >
            <a
              href="#the-top"
              class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
              aria-label="Faire défiler jusqu&#39;au bas de la page"
              title="Faire défiler jusqu&#39;au bas de la page"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <div class="flex items-center justify-between">
    <div>
      
      
        <p class="text-sm text-neutral-500 dark:text-neutral-400">
            &copy;
            2023
            nathan.out
        </p>
      
      
      
    </div>
    
    
      <div
        class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14"
      >
        <button
          id="appearance-switcher"
          class="w-12 h-12 "
          type="button"
          title="Passer au thème sombre"
        >
          <span class="inline dark:hidden">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>

</span>
          <span class="hidden dark:inline">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>

</span>
        </button>
      </div>
    
  </div>
  
  
</footer>
<div
  id="search-wrapper"
  class="fixed inset-0 z-50 flex flex-col p-4 sm:p-6 md:p-[10vh] lg:p-[12vh] w-screen h-screen cursor-default bg-neutral-500/50 backdrop-blur-sm dark:bg-neutral-900/50 invisible"
  data-url="https://nathan-out.github.io/"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg border-neutral-200 top-20 bg-neutral dark:bg-neutral-800 dark:border-neutral-700"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-transparent focus:outline-2"
          placeholder="Rechercher"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
        title="Fermer (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
</html>
